   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 2
  13              		.file	"action_tapping.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.debug_waiting_buffer,"ax",%progbits
  18              		.align	1
  19              		.arch armv7e-m
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	debug_waiting_buffer:
  26              	.LFB14:
  27              		.file 1 "tmk_core/common/action_tapping.c"
   1:tmk_core/common/action_tapping.c **** #include <stdint.h>
   2:tmk_core/common/action_tapping.c **** #include <stdbool.h>
   3:tmk_core/common/action_tapping.c **** #include "action.h"
   4:tmk_core/common/action_tapping.c **** #include "action_layer.h"
   5:tmk_core/common/action_tapping.c **** #include "action_tapping.h"
   6:tmk_core/common/action_tapping.c **** #include "keycode.h"
   7:tmk_core/common/action_tapping.c **** #include "timer.h"
   8:tmk_core/common/action_tapping.c **** 
   9:tmk_core/common/action_tapping.c **** #ifdef DEBUG_ACTION
  10:tmk_core/common/action_tapping.c **** #    include "debug.h"
  11:tmk_core/common/action_tapping.c **** #else
  12:tmk_core/common/action_tapping.c **** #    include "nodebug.h"
  13:tmk_core/common/action_tapping.c **** #endif
  14:tmk_core/common/action_tapping.c **** 
  15:tmk_core/common/action_tapping.c **** #ifndef NO_ACTION_TAPPING
  16:tmk_core/common/action_tapping.c **** 
  17:tmk_core/common/action_tapping.c **** #    define IS_TAPPING() !IS_NOEVENT(tapping_key.event)
  18:tmk_core/common/action_tapping.c **** #    define IS_TAPPING_PRESSED() (IS_TAPPING() && tapping_key.event.pressed)
  19:tmk_core/common/action_tapping.c **** #    define IS_TAPPING_RELEASED() (IS_TAPPING() && !tapping_key.event.pressed)
  20:tmk_core/common/action_tapping.c **** #    define IS_TAPPING_KEY(k) (IS_TAPPING() && KEYEQ(tapping_key.event.key, (k)))
  21:tmk_core/common/action_tapping.c **** #ifndef COMBO_ENABLE
  22:tmk_core/common/action_tapping.c **** #    define IS_TAPPING_RECORD(r) (IS_TAPPING() && KEYEQ(tapping_key.event.key, (r->event.key)))
  23:tmk_core/common/action_tapping.c **** #else
  24:tmk_core/common/action_tapping.c **** #    define IS_TAPPING_RECORD(r) (IS_TAPPING() && KEYEQ(tapping_key.event.key, (r->event.key)) && t
  25:tmk_core/common/action_tapping.c **** #endif
  26:tmk_core/common/action_tapping.c **** 
  27:tmk_core/common/action_tapping.c **** __attribute__((weak)) uint16_t get_tapping_term(uint16_t keycode, keyrecord_t *record) { return TAP
  28:tmk_core/common/action_tapping.c **** 
  29:tmk_core/common/action_tapping.c **** #    ifdef TAPPING_TERM_PER_KEY
  30:tmk_core/common/action_tapping.c **** #        define WITHIN_TAPPING_TERM(e) (TIMER_DIFF_16(e.time, tapping_key.event.time) < get_tapping
  31:tmk_core/common/action_tapping.c **** #    else
  32:tmk_core/common/action_tapping.c **** #        define WITHIN_TAPPING_TERM(e) (TIMER_DIFF_16(e.time, tapping_key.event.time) < TAPPING_TER
  33:tmk_core/common/action_tapping.c **** #    endif
  34:tmk_core/common/action_tapping.c **** 
  35:tmk_core/common/action_tapping.c **** #    ifdef TAPPING_FORCE_HOLD_PER_KEY
  36:tmk_core/common/action_tapping.c **** __attribute__((weak)) bool get_tapping_force_hold(uint16_t keycode, keyrecord_t *record) { return f
  37:tmk_core/common/action_tapping.c **** #    endif
  38:tmk_core/common/action_tapping.c **** 
  39:tmk_core/common/action_tapping.c **** #    ifdef PERMISSIVE_HOLD_PER_KEY
  40:tmk_core/common/action_tapping.c **** __attribute__((weak)) bool get_permissive_hold(uint16_t keycode, keyrecord_t *record) { return fals
  41:tmk_core/common/action_tapping.c **** #    endif
  42:tmk_core/common/action_tapping.c **** 
  43:tmk_core/common/action_tapping.c **** #    ifdef HOLD_ON_OTHER_KEY_PRESS_PER_KEY
  44:tmk_core/common/action_tapping.c **** __attribute__((weak)) bool get_hold_on_other_key_press(uint16_t keycode, keyrecord_t *record) { ret
  45:tmk_core/common/action_tapping.c **** #    endif
  46:tmk_core/common/action_tapping.c **** 
  47:tmk_core/common/action_tapping.c **** static keyrecord_t tapping_key                         = {};
  48:tmk_core/common/action_tapping.c **** static keyrecord_t waiting_buffer[WAITING_BUFFER_SIZE] = {};
  49:tmk_core/common/action_tapping.c **** static uint8_t     waiting_buffer_head                 = 0;
  50:tmk_core/common/action_tapping.c **** static uint8_t     waiting_buffer_tail                 = 0;
  51:tmk_core/common/action_tapping.c **** 
  52:tmk_core/common/action_tapping.c **** static bool process_tapping(keyrecord_t *record);
  53:tmk_core/common/action_tapping.c **** static bool waiting_buffer_enq(keyrecord_t record);
  54:tmk_core/common/action_tapping.c **** static void waiting_buffer_clear(void);
  55:tmk_core/common/action_tapping.c **** static bool waiting_buffer_typed(keyevent_t event);
  56:tmk_core/common/action_tapping.c **** static bool waiting_buffer_has_anykey_pressed(void);
  57:tmk_core/common/action_tapping.c **** static void waiting_buffer_scan_tap(void);
  58:tmk_core/common/action_tapping.c **** static void debug_tapping_key(void);
  59:tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void);
  60:tmk_core/common/action_tapping.c **** 
  61:tmk_core/common/action_tapping.c **** /** \brief Action Tapping Process
  62:tmk_core/common/action_tapping.c ****  *
  63:tmk_core/common/action_tapping.c ****  * FIXME: Needs doc
  64:tmk_core/common/action_tapping.c ****  */
  65:tmk_core/common/action_tapping.c **** void action_tapping_process(keyrecord_t record) {
  66:tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
  67:tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
  68:tmk_core/common/action_tapping.c ****             debug("processed: ");
  69:tmk_core/common/action_tapping.c ****             debug_record(record);
  70:tmk_core/common/action_tapping.c ****             debug("\n");
  71:tmk_core/common/action_tapping.c ****         }
  72:tmk_core/common/action_tapping.c ****     } else {
  73:tmk_core/common/action_tapping.c ****         if (!waiting_buffer_enq(record)) {
  74:tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
  75:tmk_core/common/action_tapping.c ****             debug("OVERFLOW: CLEAR ALL STATES\n");
  76:tmk_core/common/action_tapping.c ****             clear_keyboard();
  77:tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
  78:tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
  79:tmk_core/common/action_tapping.c ****         }
  80:tmk_core/common/action_tapping.c ****     }
  81:tmk_core/common/action_tapping.c **** 
  82:tmk_core/common/action_tapping.c ****     // process waiting_buffer
  83:tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event) && waiting_buffer_head != waiting_buffer_tail) {
  84:tmk_core/common/action_tapping.c ****         debug("---- action_exec: process waiting_buffer -----\n");
  85:tmk_core/common/action_tapping.c ****     }
  86:tmk_core/common/action_tapping.c ****     for (; waiting_buffer_tail != waiting_buffer_head; waiting_buffer_tail = (waiting_buffer_tail +
  87:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
  88:tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer[");
  89:tmk_core/common/action_tapping.c ****             debug_dec(waiting_buffer_tail);
  90:tmk_core/common/action_tapping.c ****             debug("] = ");
  91:tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]);
  92:tmk_core/common/action_tapping.c ****             debug("\n\n");
  93:tmk_core/common/action_tapping.c ****         } else {
  94:tmk_core/common/action_tapping.c ****             break;
  95:tmk_core/common/action_tapping.c ****         }
  96:tmk_core/common/action_tapping.c ****     }
  97:tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event)) {
  98:tmk_core/common/action_tapping.c ****         debug("\n");
  99:tmk_core/common/action_tapping.c ****     }
 100:tmk_core/common/action_tapping.c **** }
 101:tmk_core/common/action_tapping.c **** 
 102:tmk_core/common/action_tapping.c **** /** \brief Tapping
 103:tmk_core/common/action_tapping.c ****  *
 104:tmk_core/common/action_tapping.c ****  * Rule: Tap key is typed(pressed and released) within TAPPING_TERM.
 105:tmk_core/common/action_tapping.c ****  *       (without interfering by typing other key)
 106:tmk_core/common/action_tapping.c ****  */
 107:tmk_core/common/action_tapping.c **** /* return true when key event is processed or consumed. */
 108:tmk_core/common/action_tapping.c **** bool process_tapping(keyrecord_t *keyp) {
 109:tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 110:tmk_core/common/action_tapping.c **** 
 111:tmk_core/common/action_tapping.c ****     // if tapping
 112:tmk_core/common/action_tapping.c ****     if (IS_TAPPING_PRESSED()) {
 113:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 114:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 115:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_RECORD(keyp) && !event.pressed) {
 116:tmk_core/common/action_tapping.c ****                     // first tap!
 117:tmk_core/common/action_tapping.c ****                     debug("Tapping: First tap(0->1).\n");
 118:tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 119:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 120:tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 121:tmk_core/common/action_tapping.c **** 
 122:tmk_core/common/action_tapping.c ****                     // copy tapping state
 123:tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 124:tmk_core/common/action_tapping.c ****                     // enqueue
 125:tmk_core/common/action_tapping.c ****                     return false;
 126:tmk_core/common/action_tapping.c ****                 }
 127:tmk_core/common/action_tapping.c ****                 /* Process a key typed within TAPPING_TERM
 128:tmk_core/common/action_tapping.c ****                  * This can register the key before settlement of tapping,
 129:tmk_core/common/action_tapping.c ****                  * useful for long TAPPING_TERM but may prevent fast typing.
 130:tmk_core/common/action_tapping.c ****                  */
 131:tmk_core/common/action_tapping.c **** #    if defined(TAPPING_TERM_PER_KEY) || (TAPPING_TERM >= 500) || defined(PERMISSIVE_HOLD) || defin
 132:tmk_core/common/action_tapping.c ****                 else if (((
 133:tmk_core/common/action_tapping.c **** #        ifdef TAPPING_TERM_PER_KEY
 134:tmk_core/common/action_tapping.c ****                               get_tapping_term(get_record_keycode(&tapping_key, false), keyp)
 135:tmk_core/common/action_tapping.c **** #        else
 136:tmk_core/common/action_tapping.c ****                               TAPPING_TERM
 137:tmk_core/common/action_tapping.c **** #        endif
 138:tmk_core/common/action_tapping.c ****                               >= 500)
 139:tmk_core/common/action_tapping.c **** 
 140:tmk_core/common/action_tapping.c **** #        ifdef PERMISSIVE_HOLD_PER_KEY
 141:tmk_core/common/action_tapping.c ****                           || get_permissive_hold(get_record_keycode(&tapping_key, false), keyp)
 142:tmk_core/common/action_tapping.c **** #        elif defined(PERMISSIVE_HOLD)
 143:tmk_core/common/action_tapping.c ****                           || true
 144:tmk_core/common/action_tapping.c **** #        endif
 145:tmk_core/common/action_tapping.c ****                               ) &&
 146:tmk_core/common/action_tapping.c ****                          IS_RELEASED(event) && waiting_buffer_typed(event)) {
 147:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 148:tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 149:tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 150:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 151:tmk_core/common/action_tapping.c ****                     // enqueue
 152:tmk_core/common/action_tapping.c ****                     return false;
 153:tmk_core/common/action_tapping.c ****                 }
 154:tmk_core/common/action_tapping.c **** #    endif
 155:tmk_core/common/action_tapping.c ****                 /* Process release event of a key pressed before tapping starts
 156:tmk_core/common/action_tapping.c ****                  * Without this unexpected repeating will occur with having fast repeating setting
 157:tmk_core/common/action_tapping.c ****                  * https://github.com/tmk/tmk_keyboard/issues/60
 158:tmk_core/common/action_tapping.c ****                  */
 159:tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && !waiting_buffer_typed(event)) {
 160:tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 161:tmk_core/common/action_tapping.c ****                     action_t action = layer_switch_get_action(event.key);
 162:tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 163:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 164:tmk_core/common/action_tapping.c ****                         case ACT_RMODS:
 165:tmk_core/common/action_tapping.c ****                             if (action.key.mods && !action.key.code) return false;
 166:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 167:tmk_core/common/action_tapping.c ****                             break;
 168:tmk_core/common/action_tapping.c ****                         case ACT_LMODS_TAP:
 169:tmk_core/common/action_tapping.c ****                         case ACT_RMODS_TAP:
 170:tmk_core/common/action_tapping.c ****                             if (action.key.mods && keyp->tap.count == 0) return false;
 171:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 172:tmk_core/common/action_tapping.c ****                             break;
 173:tmk_core/common/action_tapping.c ****                     }
 174:tmk_core/common/action_tapping.c ****                     // Release of key should be process immediately.
 175:tmk_core/common/action_tapping.c ****                     debug("Tapping: release event of a key pressed before tapping\n");
 176:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 177:tmk_core/common/action_tapping.c ****                     return true;
 178:tmk_core/common/action_tapping.c ****                 } else {
 179:tmk_core/common/action_tapping.c ****                     // set interrupted flag when other key preesed during tapping
 180:tmk_core/common/action_tapping.c ****                     if (event.pressed) {
 181:tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 182:tmk_core/common/action_tapping.c **** #    if defined(HOLD_ON_OTHER_KEY_PRESS) || defined(HOLD_ON_OTHER_KEY_PRESS_PER_KEY)
 183:tmk_core/common/action_tapping.c **** #        if defined(HOLD_ON_OTHER_KEY_PRESS_PER_KEY)
 184:tmk_core/common/action_tapping.c ****                         if (get_hold_on_other_key_press(get_record_keycode(&tapping_key, false), ke
 185:tmk_core/common/action_tapping.c **** #        endif
 186:tmk_core/common/action_tapping.c ****                         {
 187:tmk_core/common/action_tapping.c ****                             debug("Tapping: End. No tap. Interfered by pressed key\n");
 188:tmk_core/common/action_tapping.c ****                             process_record(&tapping_key);
 189:tmk_core/common/action_tapping.c ****                             tapping_key = (keyrecord_t){};
 190:tmk_core/common/action_tapping.c ****                             debug_tapping_key();
 191:tmk_core/common/action_tapping.c ****                             // enqueue
 192:tmk_core/common/action_tapping.c ****                             return false;
 193:tmk_core/common/action_tapping.c ****                         }
 194:tmk_core/common/action_tapping.c **** #    endif
 195:tmk_core/common/action_tapping.c ****                     }
 196:tmk_core/common/action_tapping.c ****                     // enqueue
 197:tmk_core/common/action_tapping.c ****                     return false;
 198:tmk_core/common/action_tapping.c ****                 }
 199:tmk_core/common/action_tapping.c ****             }
 200:tmk_core/common/action_tapping.c ****             // tap_count > 0
 201:tmk_core/common/action_tapping.c ****             else {
 202:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_RECORD(keyp) && !event.pressed) {
 203:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 204:tmk_core/common/action_tapping.c ****                     debug_dec(tapping_key.tap.count);
 205:tmk_core/common/action_tapping.c ****                     debug(")\n");
 206:tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 207:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 208:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 209:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 210:tmk_core/common/action_tapping.c ****                     return true;
 211:tmk_core/common/action_tapping.c ****                 } else if (is_tap_record(keyp) && event.pressed) {
 212:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 213:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 214:tmk_core/common/action_tapping.c ****                         // unregister key
 215:tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){.tap = tapping_key.tap, .event.key = tapping_
 216:tmk_core/common/action_tapping.c **** #ifdef COMBO_ENABLE
 217:tmk_core/common/action_tapping.c ****                                 .keycode = tapping_key.keycode,
 218:tmk_core/common/action_tapping.c **** #endif
 219:tmk_core/common/action_tapping.c ****                                 });
 220:tmk_core/common/action_tapping.c ****                     } else {
 221:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last tap(1).\n");
 222:tmk_core/common/action_tapping.c ****                     }
 223:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 224:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 225:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 226:tmk_core/common/action_tapping.c ****                     return true;
 227:tmk_core/common/action_tapping.c ****                 } else {
 228:tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 229:tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 230:tmk_core/common/action_tapping.c ****                     }
 231:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 232:tmk_core/common/action_tapping.c ****                     return true;
 233:tmk_core/common/action_tapping.c ****                 }
 234:tmk_core/common/action_tapping.c ****             }
 235:tmk_core/common/action_tapping.c ****         }
 236:tmk_core/common/action_tapping.c ****         // after TAPPING_TERM
 237:tmk_core/common/action_tapping.c ****         else {
 238:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 239:tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 240:tmk_core/common/action_tapping.c ****                 debug_event(event);
 241:tmk_core/common/action_tapping.c ****                 debug("\n");
 242:tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 243:tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 244:tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 245:tmk_core/common/action_tapping.c ****                 return false;
 246:tmk_core/common/action_tapping.c ****             } else {
 247:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_RECORD(keyp) && !event.pressed) {
 248:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 249:tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 250:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 251:tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 252:tmk_core/common/action_tapping.c ****                     return true;
 253:tmk_core/common/action_tapping.c ****                 } else if (is_tap_record(keyp) && event.pressed) {
 254:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 255:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 256:tmk_core/common/action_tapping.c ****                         // unregister key
 257:tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){.tap = tapping_key.tap, .event.key = tapping_
 258:tmk_core/common/action_tapping.c **** #ifdef COMBO_ENABLE
 259:tmk_core/common/action_tapping.c ****                                 .keycode = tapping_key.keycode,
 260:tmk_core/common/action_tapping.c **** #endif
 261:tmk_core/common/action_tapping.c ****                                 });
 262:tmk_core/common/action_tapping.c ****                     } else {
 263:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last timeout tap(1).\n");
 264:tmk_core/common/action_tapping.c ****                     }
 265:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 266:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 267:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 268:tmk_core/common/action_tapping.c ****                     return true;
 269:tmk_core/common/action_tapping.c ****                 } else {
 270:tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 271:tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last timeout tap(>0).\n");
 272:tmk_core/common/action_tapping.c ****                     }
 273:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 274:tmk_core/common/action_tapping.c ****                     return true;
 275:tmk_core/common/action_tapping.c ****                 }
 276:tmk_core/common/action_tapping.c ****             }
 277:tmk_core/common/action_tapping.c ****         }
 278:tmk_core/common/action_tapping.c ****     } else if (IS_TAPPING_RELEASED()) {
 279:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 280:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 281:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_RECORD(keyp)) {
 282:tmk_core/common/action_tapping.c **** //#    ifndef TAPPING_FORCE_HOLD
 283:tmk_core/common/action_tapping.c **** #    if !defined(TAPPING_FORCE_HOLD) || defined(TAPPING_FORCE_HOLD_PER_KEY)
 284:tmk_core/common/action_tapping.c ****                     if (
 285:tmk_core/common/action_tapping.c **** #        ifdef TAPPING_FORCE_HOLD_PER_KEY
 286:tmk_core/common/action_tapping.c ****                         !get_tapping_force_hold(get_record_keycode(&tapping_key, false), keyp) &&
 287:tmk_core/common/action_tapping.c **** #        endif
 288:tmk_core/common/action_tapping.c ****                         !tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 289:tmk_core/common/action_tapping.c ****                         // sequential tap.
 290:tmk_core/common/action_tapping.c ****                         keyp->tap = tapping_key.tap;
 291:tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 292:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 293:tmk_core/common/action_tapping.c ****                         debug_dec(keyp->tap.count);
 294:tmk_core/common/action_tapping.c ****                         debug(")\n");
 295:tmk_core/common/action_tapping.c ****                         process_record(keyp);
 296:tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 297:tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 298:tmk_core/common/action_tapping.c ****                         return true;
 299:tmk_core/common/action_tapping.c ****                     }
 300:tmk_core/common/action_tapping.c **** #    endif
 301:tmk_core/common/action_tapping.c ****                     // FIX: start new tap again
 302:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 303:tmk_core/common/action_tapping.c ****                     return true;
 304:tmk_core/common/action_tapping.c ****                 } else if (is_tap_record(keyp)) {
 305:tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 306:tmk_core/common/action_tapping.c ****                     debug("Tapping: Start with interfering other tap.\n");
 307:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 308:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 309:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 310:tmk_core/common/action_tapping.c ****                     return true;
 311:tmk_core/common/action_tapping.c ****                 } else {
 312:tmk_core/common/action_tapping.c ****                     // should none in buffer
 313:tmk_core/common/action_tapping.c ****                     // FIX: interrupted when other key is pressed
 314:tmk_core/common/action_tapping.c ****                     tapping_key.tap.interrupted = true;
 315:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 316:tmk_core/common/action_tapping.c ****                     return true;
 317:tmk_core/common/action_tapping.c ****                 }
 318:tmk_core/common/action_tapping.c ****             } else {
 319:tmk_core/common/action_tapping.c ****                 if (!IS_NOEVENT(event)) debug("Tapping: other key just after tap.\n");
 320:tmk_core/common/action_tapping.c ****                 process_record(keyp);
 321:tmk_core/common/action_tapping.c ****                 return true;
 322:tmk_core/common/action_tapping.c ****             }
 323:tmk_core/common/action_tapping.c ****         } else {
 324:tmk_core/common/action_tapping.c ****             // FIX: process_action here?
 325:tmk_core/common/action_tapping.c ****             // timeout. no sequential tap.
 326:tmk_core/common/action_tapping.c ****             debug("Tapping: End(Timeout after releasing last tap): ");
 327:tmk_core/common/action_tapping.c ****             debug_event(event);
 328:tmk_core/common/action_tapping.c ****             debug("\n");
 329:tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 330:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 331:tmk_core/common/action_tapping.c ****             return false;
 332:tmk_core/common/action_tapping.c ****         }
 333:tmk_core/common/action_tapping.c ****     }
 334:tmk_core/common/action_tapping.c ****     // not tapping state
 335:tmk_core/common/action_tapping.c ****     else {
 336:tmk_core/common/action_tapping.c ****         if (event.pressed && is_tap_record(keyp)) {
 337:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 338:tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 339:tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 340:tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 341:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 342:tmk_core/common/action_tapping.c ****             return true;
 343:tmk_core/common/action_tapping.c ****         } else {
 344:tmk_core/common/action_tapping.c ****             process_record(keyp);
 345:tmk_core/common/action_tapping.c ****             return true;
 346:tmk_core/common/action_tapping.c ****         }
 347:tmk_core/common/action_tapping.c ****     }
 348:tmk_core/common/action_tapping.c **** }
 349:tmk_core/common/action_tapping.c **** 
 350:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer enq
 351:tmk_core/common/action_tapping.c ****  *
 352:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 353:tmk_core/common/action_tapping.c ****  */
 354:tmk_core/common/action_tapping.c **** bool waiting_buffer_enq(keyrecord_t record) {
 355:tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 356:tmk_core/common/action_tapping.c ****         return true;
 357:tmk_core/common/action_tapping.c ****     }
 358:tmk_core/common/action_tapping.c **** 
 359:tmk_core/common/action_tapping.c ****     if ((waiting_buffer_head + 1) % WAITING_BUFFER_SIZE == waiting_buffer_tail) {
 360:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 361:tmk_core/common/action_tapping.c ****         return false;
 362:tmk_core/common/action_tapping.c ****     }
 363:tmk_core/common/action_tapping.c **** 
 364:tmk_core/common/action_tapping.c ****     waiting_buffer[waiting_buffer_head] = record;
 365:tmk_core/common/action_tapping.c ****     waiting_buffer_head                 = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 366:tmk_core/common/action_tapping.c **** 
 367:tmk_core/common/action_tapping.c ****     debug("waiting_buffer_enq: ");
 368:tmk_core/common/action_tapping.c ****     debug_waiting_buffer();
 369:tmk_core/common/action_tapping.c ****     return true;
 370:tmk_core/common/action_tapping.c **** }
 371:tmk_core/common/action_tapping.c **** 
 372:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer clear
 373:tmk_core/common/action_tapping.c ****  *
 374:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 375:tmk_core/common/action_tapping.c ****  */
 376:tmk_core/common/action_tapping.c **** void waiting_buffer_clear(void) {
 377:tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 378:tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 379:tmk_core/common/action_tapping.c **** }
 380:tmk_core/common/action_tapping.c **** 
 381:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer typed
 382:tmk_core/common/action_tapping.c ****  *
 383:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 384:tmk_core/common/action_tapping.c ****  */
 385:tmk_core/common/action_tapping.c **** bool waiting_buffer_typed(keyevent_t event) {
 386:tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 387:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 388:tmk_core/common/action_tapping.c ****             return true;
 389:tmk_core/common/action_tapping.c ****         }
 390:tmk_core/common/action_tapping.c ****     }
 391:tmk_core/common/action_tapping.c ****     return false;
 392:tmk_core/common/action_tapping.c **** }
 393:tmk_core/common/action_tapping.c **** 
 394:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer has anykey pressed
 395:tmk_core/common/action_tapping.c ****  *
 396:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 397:tmk_core/common/action_tapping.c ****  */
 398:tmk_core/common/action_tapping.c **** __attribute__((unused)) bool waiting_buffer_has_anykey_pressed(void) {
 399:tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 400:tmk_core/common/action_tapping.c ****         if (waiting_buffer[i].event.pressed) return true;
 401:tmk_core/common/action_tapping.c ****     }
 402:tmk_core/common/action_tapping.c ****     return false;
 403:tmk_core/common/action_tapping.c **** }
 404:tmk_core/common/action_tapping.c **** 
 405:tmk_core/common/action_tapping.c **** /** \brief Scan buffer for tapping
 406:tmk_core/common/action_tapping.c ****  *
 407:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 408:tmk_core/common/action_tapping.c ****  */
 409:tmk_core/common/action_tapping.c **** void waiting_buffer_scan_tap(void) {
 410:tmk_core/common/action_tapping.c ****     // tapping already is settled
 411:tmk_core/common/action_tapping.c ****     if (tapping_key.tap.count > 0) return;
 412:tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 413:tmk_core/common/action_tapping.c ****     if (!tapping_key.event.pressed) return;
 414:tmk_core/common/action_tapping.c **** 
 415:tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 416:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 417:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 418:tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 419:tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 420:tmk_core/common/action_tapping.c **** 
 421:tmk_core/common/action_tapping.c ****             debug("waiting_buffer_scan_tap: found at [");
 422:tmk_core/common/action_tapping.c ****             debug_dec(i);
 423:tmk_core/common/action_tapping.c ****             debug("]\n");
 424:tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 425:tmk_core/common/action_tapping.c ****             return;
 426:tmk_core/common/action_tapping.c ****         }
 427:tmk_core/common/action_tapping.c ****     }
 428:tmk_core/common/action_tapping.c **** }
 429:tmk_core/common/action_tapping.c **** 
 430:tmk_core/common/action_tapping.c **** /** \brief Tapping key debug print
 431:tmk_core/common/action_tapping.c ****  *
 432:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 433:tmk_core/common/action_tapping.c ****  */
 434:tmk_core/common/action_tapping.c **** static void debug_tapping_key(void) {
 435:tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY=");
 436:tmk_core/common/action_tapping.c ****     debug_record(tapping_key);
 437:tmk_core/common/action_tapping.c ****     debug("\n");
 438:tmk_core/common/action_tapping.c **** }
 439:tmk_core/common/action_tapping.c **** 
 440:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer debug print
 441:tmk_core/common/action_tapping.c ****  *
 442:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 443:tmk_core/common/action_tapping.c ****  */
 444:tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void) {
  28              		.loc 1 444 40 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
 445:tmk_core/common/action_tapping.c ****     debug("{ ");
  32              		.loc 1 445 16 view .LVU1
 446:tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  33              		.loc 1 446 5 view .LVU2
  34              	.LBB44:
  35              		.loc 1 446 10 view .LVU3
  36              	.LBE44:
 444:tmk_core/common/action_tapping.c ****     debug("{ ");
  37              		.loc 1 444 40 is_stmt 0 view .LVU4
  38 0000 70B5     		push	{r4, r5, r6, lr}
  39              		.cfi_def_cfa_offset 16
  40              		.cfi_offset 4, -16
  41              		.cfi_offset 5, -12
  42              		.cfi_offset 6, -8
  43              		.cfi_offset 14, -4
  44              	.LBB45:
  45              		.loc 1 446 18 view .LVU5
  46 0002 094B     		ldr	r3, .L4
  47              		.loc 1 446 45 view .LVU6
  48 0004 094E     		ldr	r6, .L4+4
  49              		.loc 1 446 18 view .LVU7
  50 0006 1C78     		ldrb	r4, [r3]	@ zero_extendqisi2
  51              	.LVL0:
 447:tmk_core/common/action_tapping.c ****         debug("[");
 448:tmk_core/common/action_tapping.c ****         debug_dec(i);
 449:tmk_core/common/action_tapping.c ****         debug("]=");
 450:tmk_core/common/action_tapping.c ****         debug_record(waiting_buffer[i]);
  52              		.loc 1 450 9 view .LVU8
  53 0008 094D     		ldr	r5, .L4+8
  54              	.L2:
 446:tmk_core/common/action_tapping.c ****         debug("[");
  55              		.loc 1 446 43 is_stmt 1 discriminator 1 view .LVU9
 446:tmk_core/common/action_tapping.c ****         debug("[");
  56              		.loc 1 446 5 is_stmt 0 discriminator 1 view .LVU10
  57 000a 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
  58 000c A342     		cmp	r3, r4
  59 000e 00D1     		bne	.L3
 446:tmk_core/common/action_tapping.c ****         debug("[");
  60              		.loc 1 446 5 discriminator 1 view .LVU11
  61              	.LBE45:
 451:tmk_core/common/action_tapping.c ****         debug(" ");
 452:tmk_core/common/action_tapping.c ****     }
 453:tmk_core/common/action_tapping.c ****     debug("}\n");
 454:tmk_core/common/action_tapping.c **** }
  62              		.loc 1 454 1 view .LVU12
  63 0010 70BD     		pop	{r4, r5, r6, pc}
  64              	.LVL1:
  65              	.L3:
  66              	.LBB46:
 447:tmk_core/common/action_tapping.c ****         debug_dec(i);
  67              		.loc 1 447 19 is_stmt 1 discriminator 3 view .LVU13
 448:tmk_core/common/action_tapping.c ****         debug("]=");
  68              		.loc 1 448 21 discriminator 3 view .LVU14
 449:tmk_core/common/action_tapping.c ****         debug_record(waiting_buffer[i]);
  69              		.loc 1 449 20 discriminator 3 view .LVU15
 450:tmk_core/common/action_tapping.c ****         debug(" ");
  70              		.loc 1 450 9 discriminator 3 view .LVU16
  71 0012 05EBC403 		add	r3, r5, r4, lsl #3
  72 0016 55F83400 		ldr	r0, [r5, r4, lsl #3]	@ unaligned
  73 001a 5968     		ldr	r1, [r3, #4]	@ unaligned
 446:tmk_core/common/action_tapping.c ****         debug("[");
  74              		.loc 1 446 76 is_stmt 0 discriminator 3 view .LVU17
  75 001c 0134     		adds	r4, r4, #1
  76              	.LVL2:
 450:tmk_core/common/action_tapping.c ****         debug(" ");
  77              		.loc 1 450 9 discriminator 3 view .LVU18
  78 001e FFF7FEFF 		bl	debug_record
  79              	.LVL3:
 451:tmk_core/common/action_tapping.c ****     }
  80              		.loc 1 451 19 is_stmt 1 discriminator 3 view .LVU19
 446:tmk_core/common/action_tapping.c ****         debug("[");
  81              		.loc 1 446 69 discriminator 3 view .LVU20
 446:tmk_core/common/action_tapping.c ****         debug("[");
  82              		.loc 1 446 71 is_stmt 0 discriminator 3 view .LVU21
  83 0022 04F00704 		and	r4, r4, #7
  84              	.LVL4:
 446:tmk_core/common/action_tapping.c ****         debug("[");
  85              		.loc 1 446 71 discriminator 3 view .LVU22
  86 0026 F0E7     		b	.L2
  87              	.L5:
  88              		.align	2
  89              	.L4:
  90 0028 00000000 		.word	.LANCHOR0
  91 002c 00000000 		.word	.LANCHOR2
  92 0030 00000000 		.word	.LANCHOR1
  93              	.LBE46:
  94              		.cfi_endproc
  95              	.LFE14:
  97              		.section	.text.debug_tapping_key,"ax",%progbits
  98              		.align	1
  99              		.syntax unified
 100              		.thumb
 101              		.thumb_func
 102              		.fpu fpv4-sp-d16
 104              	debug_tapping_key:
 105              	.LFB13:
 434:tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY=");
 106              		.loc 1 434 37 is_stmt 1 view -0
 107              		.cfi_startproc
 108              		@ args = 0, pretend = 0, frame = 0
 109              		@ frame_needed = 0, uses_anonymous_args = 0
 110              		@ link register save eliminated.
 435:tmk_core/common/action_tapping.c ****     debug_record(tapping_key);
 111              		.loc 1 435 26 view .LVU24
 436:tmk_core/common/action_tapping.c ****     debug("\n");
 112              		.loc 1 436 5 view .LVU25
 113 0000 024B     		ldr	r3, .L7
 114 0002 1868     		ldr	r0, [r3]	@ unaligned
 115 0004 5968     		ldr	r1, [r3, #4]	@ unaligned
 116 0006 FFF7FEBF 		b	debug_record
 117              	.LVL5:
 118              	.L8:
 119 000a 00BF     		.align	2
 120              	.L7:
 121 000c 00000000 		.word	.LANCHOR3
 122              		.cfi_endproc
 123              	.LFE13:
 125              		.section	.text.waiting_buffer_scan_tap,"ax",%progbits
 126              		.align	1
 127              		.syntax unified
 128              		.thumb
 129              		.thumb_func
 130              		.fpu fpv4-sp-d16
 132              	waiting_buffer_scan_tap:
 133              	.LFB12:
 409:tmk_core/common/action_tapping.c ****     // tapping already is settled
 134              		.loc 1 409 36 view -0
 135              		.cfi_startproc
 136              		@ args = 0, pretend = 0, frame = 8
 137              		@ frame_needed = 0, uses_anonymous_args = 0
 411:tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 138              		.loc 1 411 5 view .LVU27
 411:tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 139              		.loc 1 411 31 is_stmt 0 view .LVU28
 140 0000 214B     		ldr	r3, .L20
 409:tmk_core/common/action_tapping.c ****     // tapping already is settled
 141              		.loc 1 409 36 view .LVU29
 142 0002 F7B5     		push	{r0, r1, r2, r4, r5, r6, r7, lr}
 143              		.cfi_def_cfa_offset 32
 144              		.cfi_offset 4, -20
 145              		.cfi_offset 5, -16
 146              		.cfi_offset 6, -12
 147              		.cfi_offset 7, -8
 148              		.cfi_offset 14, -4
 411:tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 149              		.loc 1 411 31 view .LVU30
 150 0004 9A79     		ldrb	r2, [r3, #6]	@ zero_extendqisi2
 411:tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 151              		.loc 1 411 8 view .LVU31
 152 0006 12F0F00F 		tst	r2, #240
 153 000a 0AD1     		bne	.L9
 413:tmk_core/common/action_tapping.c **** 
 154              		.loc 1 413 5 is_stmt 1 view .LVU32
 413:tmk_core/common/action_tapping.c **** 
 155              		.loc 1 413 8 is_stmt 0 view .LVU33
 156 000c 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 157 000e 42B1     		cbz	r2, .L9
 158              	.LBB52:
 159              	.LBI52:
 409:tmk_core/common/action_tapping.c ****     // tapping already is settled
 160              		.loc 1 409 6 is_stmt 1 view .LVU34
 161              	.LBE52:
 415:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 162              		.loc 1 415 5 view .LVU35
 163              	.LBB58:
 164              	.LBB53:
 415:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 165              		.loc 1 415 10 view .LVU36
 415:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 166              		.loc 1 415 18 is_stmt 0 view .LVU37
 167 0010 1E4A     		ldr	r2, .L20+4
 415:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 168              		.loc 1 415 45 view .LVU38
 169 0012 1F4E     		ldr	r6, .L20+8
 415:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 170              		.loc 1 415 18 view .LVU39
 171 0014 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 172              	.LVL6:
 416:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 173              		.loc 1 416 13 view .LVU40
 174 0016 1F4D     		ldr	r5, .L20+12
 416:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 175              		.loc 1 416 12 view .LVU41
 176 0018 4FF6FF77 		movw	r7, #65535
 177              	.L13:
 415:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 178              		.loc 1 415 43 is_stmt 1 view .LVU42
 415:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 179              		.loc 1 415 5 is_stmt 0 view .LVU43
 180 001c 3178     		ldrb	r1, [r6]	@ zero_extendqisi2
 181 001e 9142     		cmp	r1, r2
 182 0020 01D1     		bne	.L16
 183              	.LVL7:
 184              	.L9:
 415:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 185              		.loc 1 415 5 view .LVU44
 186              	.LBE53:
 187              	.LBE58:
 428:tmk_core/common/action_tapping.c **** 
 188              		.loc 1 428 1 view .LVU45
 189 0022 03B0     		add	sp, sp, #12
 190              		.cfi_remember_state
 191              		.cfi_def_cfa_offset 20
 192              		@ sp needed
 193 0024 F0BD     		pop	{r4, r5, r6, r7, pc}
 194              	.LVL8:
 195              	.L16:
 196              		.cfi_restore_state
 197              	.LBB59:
 198              	.LBB56:
 416:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 199              		.loc 1 416 9 is_stmt 1 view .LVU46
 200 0026 1868     		ldr	r0, [r3]	@ unaligned
 201 0028 0090     		str	r0, [sp]
 202 002a 9888     		ldrh	r0, [r3, #4]
 203              	.LVL9:
 204              	.LBB54:
 205              	.LBI54:
 206              		.file 2 "tmk_core/common/keyboard.h"
   1:tmk_core/common/keyboard.h **** /*
   2:tmk_core/common/keyboard.h **** Copyright 2011,2012,2013 Jun Wako <wakojun@gmail.com>
   3:tmk_core/common/keyboard.h **** 
   4:tmk_core/common/keyboard.h **** This program is free software: you can redistribute it and/or modify
   5:tmk_core/common/keyboard.h **** it under the terms of the GNU General Public License as published by
   6:tmk_core/common/keyboard.h **** the Free Software Foundation, either version 2 of the License, or
   7:tmk_core/common/keyboard.h **** (at your option) any later version.
   8:tmk_core/common/keyboard.h **** 
   9:tmk_core/common/keyboard.h **** This program is distributed in the hope that it will be useful,
  10:tmk_core/common/keyboard.h **** but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:tmk_core/common/keyboard.h **** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:tmk_core/common/keyboard.h **** GNU General Public License for more details.
  13:tmk_core/common/keyboard.h **** 
  14:tmk_core/common/keyboard.h **** You should have received a copy of the GNU General Public License
  15:tmk_core/common/keyboard.h **** along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:tmk_core/common/keyboard.h **** */
  17:tmk_core/common/keyboard.h **** 
  18:tmk_core/common/keyboard.h **** #pragma once
  19:tmk_core/common/keyboard.h **** 
  20:tmk_core/common/keyboard.h **** #include <stdbool.h>
  21:tmk_core/common/keyboard.h **** #include <stdint.h>
  22:tmk_core/common/keyboard.h **** 
  23:tmk_core/common/keyboard.h **** #ifdef __cplusplus
  24:tmk_core/common/keyboard.h **** extern "C" {
  25:tmk_core/common/keyboard.h **** #endif
  26:tmk_core/common/keyboard.h **** 
  27:tmk_core/common/keyboard.h **** /* key matrix position */
  28:tmk_core/common/keyboard.h **** typedef struct {
  29:tmk_core/common/keyboard.h ****     uint8_t col;
  30:tmk_core/common/keyboard.h ****     uint8_t row;
  31:tmk_core/common/keyboard.h **** } keypos_t;
  32:tmk_core/common/keyboard.h **** 
  33:tmk_core/common/keyboard.h **** /* key event */
  34:tmk_core/common/keyboard.h **** typedef struct {
  35:tmk_core/common/keyboard.h ****     keypos_t key;
  36:tmk_core/common/keyboard.h ****     bool     pressed;
  37:tmk_core/common/keyboard.h ****     uint16_t time;
  38:tmk_core/common/keyboard.h **** } keyevent_t;
  39:tmk_core/common/keyboard.h **** 
  40:tmk_core/common/keyboard.h **** /* equivalent test of keypos_t */
  41:tmk_core/common/keyboard.h **** #define KEYEQ(keya, keyb) ((keya).row == (keyb).row && (keya).col == (keyb).col)
  42:tmk_core/common/keyboard.h **** 
  43:tmk_core/common/keyboard.h **** /* Rules for No Event:
  44:tmk_core/common/keyboard.h ****  * 1) (time == 0) to handle (keyevent_t){} as empty event
  45:tmk_core/common/keyboard.h ****  * 2) Matrix(255, 255) to make TICK event available
  46:tmk_core/common/keyboard.h ****  */
  47:tmk_core/common/keyboard.h **** static inline bool IS_NOEVENT(keyevent_t event) { return event.time == 0 || (event.key.row == 255 &
 207              		.loc 2 47 20 view .LVU47
 208              	.LBB55:
 209              		.loc 2 47 51 view .LVU48
 210              		.loc 2 47 74 is_stmt 0 view .LVU49
 211 002c 40B3     		cbz	r0, .L15
 212              		.loc 2 47 99 view .LVU50
 213 002e BDF80010 		ldrh	r1, [sp]
 214              	.LVL10:
 215              		.loc 2 47 99 view .LVU51
 216              	.LBE55:
 217              	.LBE54:
 416:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 218              		.loc 1 416 12 view .LVU52
 219 0032 B942     		cmp	r1, r7
 220 0034 24D0     		beq	.L15
 416:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 221              		.loc 1 416 13 view .LVU53
 222 0036 05EBC204 		add	r4, r5, r2, lsl #3
 223 003a 93F801C0 		ldrb	ip, [r3, #1]	@ zero_extendqisi2
 224 003e 6178     		ldrb	r1, [r4, #1]	@ zero_extendqisi2
 225 0040 8C45     		cmp	ip, r1
 226 0042 1DD1     		bne	.L15
 227 0044 93F800C0 		ldrb	ip, [r3]	@ zero_extendqisi2
 228 0048 15F83210 		ldrb	r1, [r5, r2, lsl #3]	@ zero_extendqisi2
 229 004c 8C45     		cmp	ip, r1
 230 004e 17D1     		bne	.L15
 416:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 231              		.loc 1 416 57 view .LVU54
 232 0050 A178     		ldrb	r1, [r4, #2]	@ zero_extendqisi2
 233 0052 A9B9     		cbnz	r1, .L15
 416:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 234              		.loc 1 416 96 view .LVU55
 235 0054 A188     		ldrh	r1, [r4, #4]
 236 0056 091A     		subs	r1, r1, r0
 416:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 237              		.loc 1 416 93 view .LVU56
 238 0058 89B2     		uxth	r1, r1
 239 005a B329     		cmp	r1, #179
 240 005c 10D8     		bhi	.L15
 417:tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 241              		.loc 1 417 13 is_stmt 1 view .LVU57
 417:tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 242              		.loc 1 417 41 is_stmt 0 view .LVU58
 243 005e 9979     		ldrb	r1, [r3, #6]	@ zero_extendqisi2
 419:tmk_core/common/action_tapping.c **** 
 244              		.loc 1 419 13 view .LVU59
 245 0060 0948     		ldr	r0, .L20
 417:tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 246              		.loc 1 417 41 view .LVU60
 247 0062 0122     		movs	r2, #1
 248              	.LVL11:
 417:tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 249              		.loc 1 417 41 view .LVU61
 250 0064 62F30711 		bfi	r1, r2, #4, #4
 251 0068 9971     		strb	r1, [r3, #6]
 418:tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 252              		.loc 1 418 13 is_stmt 1 view .LVU62
 418:tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 253              		.loc 1 418 41 is_stmt 0 view .LVU63
 254 006a A379     		ldrb	r3, [r4, #6]	@ zero_extendqisi2
 255 006c 62F30713 		bfi	r3, r2, #4, #4
 256 0070 A371     		strb	r3, [r4, #6]
 419:tmk_core/common/action_tapping.c **** 
 257              		.loc 1 419 13 is_stmt 1 view .LVU64
 258 0072 FFF7FEFF 		bl	process_record
 259              	.LVL12:
 421:tmk_core/common/action_tapping.c ****             debug_dec(i);
 260              		.loc 1 421 57 view .LVU65
 422:tmk_core/common/action_tapping.c ****             debug("]\n");
 261              		.loc 1 422 25 view .LVU66
 423:tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 262              		.loc 1 423 25 view .LVU67
 424:tmk_core/common/action_tapping.c ****             return;
 263              		.loc 1 424 13 view .LVU68
 264              	.LBE56:
 265              	.LBE59:
 428:tmk_core/common/action_tapping.c **** 
 266              		.loc 1 428 1 is_stmt 0 view .LVU69
 267 0076 03B0     		add	sp, sp, #12
 268              		.cfi_remember_state
 269              		.cfi_def_cfa_offset 20
 270              		@ sp needed
 271 0078 BDE8F040 		pop	{r4, r5, r6, r7, lr}
 272              		.cfi_restore 14
 273              		.cfi_restore 7
 274              		.cfi_restore 6
 275              		.cfi_restore 5
 276              		.cfi_restore 4
 277              		.cfi_def_cfa_offset 0
 278              	.LBB60:
 279              	.LBB57:
 424:tmk_core/common/action_tapping.c ****             return;
 280              		.loc 1 424 13 view .LVU70
 281 007c FFF7FEBF 		b	debug_waiting_buffer
 282              	.LVL13:
 283              	.L15:
 284              		.cfi_restore_state
 415:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 285              		.loc 1 415 69 is_stmt 1 view .LVU71
 415:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 286              		.loc 1 415 76 is_stmt 0 view .LVU72
 287 0080 0132     		adds	r2, r2, #1
 288              	.LVL14:
 415:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 289              		.loc 1 415 71 view .LVU73
 290 0082 02F00702 		and	r2, r2, #7
 291              	.LVL15:
 415:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 292              		.loc 1 415 71 view .LVU74
 293 0086 C9E7     		b	.L13
 294              	.L21:
 295              		.align	2
 296              	.L20:
 297 0088 00000000 		.word	.LANCHOR3
 298 008c 00000000 		.word	.LANCHOR0
 299 0090 00000000 		.word	.LANCHOR2
 300 0094 00000000 		.word	.LANCHOR1
 301              	.LBE57:
 302              	.LBE60:
 303              		.cfi_endproc
 304              	.LFE12:
 306              		.section	.text.process_tapping,"ax",%progbits
 307              		.align	1
 308              		.syntax unified
 309              		.thumb
 310              		.thumb_func
 311              		.fpu fpv4-sp-d16
 313              	process_tapping:
 314              	.LVL16:
 315              	.LFB7:
 108:tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 316              		.loc 1 108 41 is_stmt 1 view -0
 317              		.cfi_startproc
 318              		@ args = 0, pretend = 0, frame = 16
 319              		@ frame_needed = 0, uses_anonymous_args = 0
 109:tmk_core/common/action_tapping.c **** 
 320              		.loc 1 109 5 view .LVU76
 108:tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 321              		.loc 1 108 41 is_stmt 0 view .LVU77
 322 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 323              		.cfi_def_cfa_offset 28
 324              		.cfi_offset 4, -28
 325              		.cfi_offset 5, -24
 326              		.cfi_offset 6, -20
 327              		.cfi_offset 7, -16
 328              		.cfi_offset 8, -12
 329              		.cfi_offset 9, -8
 330              		.cfi_offset 14, -4
 331 0004 0546     		mov	r5, r0
 332 0006 85B0     		sub	sp, sp, #20
 333              		.cfi_def_cfa_offset 48
 334 0008 A54C     		ldr	r4, .L115
 109:tmk_core/common/action_tapping.c **** 
 335              		.loc 1 109 16 view .LVU78
 336 000a AB88     		ldrh	r3, [r5, #4]	@ unaligned
 337 000c ADF80430 		strh	r3, [sp, #4]	@ unaligned
 338 0010 A388     		ldrh	r3, [r4, #4]	@ unaligned
 339 0012 0068     		ldr	r0, [r0]	@ unaligned
 340              	.LVL17:
 109:tmk_core/common/action_tapping.c **** 
 341              		.loc 1 109 16 view .LVU79
 342 0014 ADF80C30 		strh	r3, [sp, #12]	@ unaligned
 343 0018 A388     		ldrh	r3, [r4, #4]
 344 001a 0090     		str	r0, [sp]
 345 001c 2068     		ldr	r0, [r4]	@ unaligned
 346 001e 2978     		ldrb	r1, [r5]	@ zero_extendqisi2
 347              	.LVL18:
 109:tmk_core/common/action_tapping.c **** 
 348              		.loc 1 109 16 view .LVU80
 349 0020 6A78     		ldrb	r2, [r5, #1]	@ zero_extendqisi2
 350              	.LVL19:
 109:tmk_core/common/action_tapping.c **** 
 351              		.loc 1 109 16 view .LVU81
 352 0022 AF78     		ldrb	r7, [r5, #2]	@ zero_extendqisi2
 353              	.LVL20:
 109:tmk_core/common/action_tapping.c **** 
 354              		.loc 1 109 16 view .LVU82
 355 0024 B5F80480 		ldrh	r8, [r5, #4]
 356              	.LVL21:
 112:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 357              		.loc 1 112 5 is_stmt 1 view .LVU83
 358              	.LBB86:
 359              	.LBI86:
 360              		.loc 2 47 20 view .LVU84
 361              	.LBB87:
 362              		.loc 2 47 51 view .LVU85
 363 0028 0290     		str	r0, [sp, #8]
 364              	.LBE87:
 365              	.LBE86:
 109:tmk_core/common/action_tapping.c **** 
 366              		.loc 1 109 16 is_stmt 0 view .LVU86
 367 002a EC46     		mov	ip, sp
 368              	.LBB89:
 369              	.LBB88:
 370              		.loc 2 47 74 view .LVU87
 371 002c 002B     		cmp	r3, #0
 372 002e 00F0D680 		beq	.L24
 373              		.loc 2 47 99 view .LVU88
 374 0032 BDF808E0 		ldrh	lr, [sp, #8]
 375              	.LVL22:
 376              		.loc 2 47 99 view .LVU89
 377              	.LBE88:
 378              	.LBE89:
 112:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 379              		.loc 1 112 8 view .LVU90
 380 0036 4FF6FF70 		movw	r0, #65535
 381 003a 8645     		cmp	lr, r0
 382 003c 00F0CF80 		beq	.L24
 112:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 383              		.loc 1 112 9 discriminator 1 view .LVU91
 384 0040 A678     		ldrb	r6, [r4, #2]	@ zero_extendqisi2
 385 0042 002E     		cmp	r6, #0
 386 0044 00F0CB80 		beq	.L24
 113:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 387              		.loc 1 113 9 is_stmt 1 view .LVU92
 113:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 388              		.loc 1 113 13 is_stmt 0 view .LVU93
 389 0048 A8EB0303 		sub	r3, r8, r3
 114:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_RECORD(keyp) && !event.pressed) {
 390              		.loc 1 114 39 view .LVU94
 391 004c A079     		ldrb	r0, [r4, #6]	@ zero_extendqisi2
 113:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 392              		.loc 1 113 12 view .LVU95
 393 004e 9BB2     		uxth	r3, r3
 394 0050 B32B     		cmp	r3, #179
 114:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_RECORD(keyp) && !event.pressed) {
 395              		.loc 1 114 39 view .LVU96
 396 0052 00F0F009 		and	r9, r0, #240
 113:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 397              		.loc 1 113 12 view .LVU97
 398 0056 00F29E80 		bhi	.L25
 114:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_RECORD(keyp) && !event.pressed) {
 399              		.loc 1 114 13 is_stmt 1 view .LVU98
 400 005a 2B88     		ldrh	r3, [r5]
 114:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_RECORD(keyp) && !event.pressed) {
 401              		.loc 1 114 16 is_stmt 0 view .LVU99
 402 005c B9F1000F 		cmp	r9, #0
 403 0060 68D1     		bne	.L26
 115:tmk_core/common/action_tapping.c ****                     // first tap!
 404              		.loc 1 115 17 is_stmt 1 view .LVU100
 405              	.LVL23:
 406              	.LBB90:
 407              	.LBI90:
 408              		.loc 2 47 20 view .LVU101
 409              	.LBB91:
 410              		.loc 2 47 51 view .LVU102
 411              		.loc 2 47 51 is_stmt 0 view .LVU103
 412              	.LBE91:
 413              	.LBE90:
 115:tmk_core/common/action_tapping.c ****                     // first tap!
 414              		.loc 1 115 21 view .LVU104
 415 0062 7345     		cmp	r3, lr
 115:tmk_core/common/action_tapping.c ****                     // first tap!
 416              		.loc 1 115 54 view .LVU105
 417 0064 B946     		mov	r9, r7
 115:tmk_core/common/action_tapping.c ****                     // first tap!
 418              		.loc 1 115 21 view .LVU106
 419 0066 10D1     		bne	.L27
 115:tmk_core/common/action_tapping.c ****                     // first tap!
 420              		.loc 1 115 45 discriminator 2 view .LVU107
 421 0068 7FB9     		cbnz	r7, .L27
 117:tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 422              		.loc 1 117 57 is_stmt 1 view .LVU108
 118:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 423              		.loc 1 118 21 view .LVU109
 118:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 424              		.loc 1 118 43 is_stmt 0 view .LVU110
 425 006a 0123     		movs	r3, #1
 426 006c 63F30710 		bfi	r0, r3, #4, #4
 427 0070 A071     		strb	r0, [r4, #6]
 119:tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 428              		.loc 1 119 21 is_stmt 1 view .LVU111
 429 0072 FFF7FEFF 		bl	debug_tapping_key
 430              	.LVL24:
 120:tmk_core/common/action_tapping.c **** 
 431              		.loc 1 120 21 view .LVU112
 432 0076 2046     		mov	r0, r4
 433 0078 FFF7FEFF 		bl	process_record
 434              	.LVL25:
 123:tmk_core/common/action_tapping.c ****                     // enqueue
 435              		.loc 1 123 21 view .LVU113
 123:tmk_core/common/action_tapping.c ****                     // enqueue
 436              		.loc 1 123 31 is_stmt 0 view .LVU114
 437 007c A379     		ldrb	r3, [r4, #6]	@ zero_extendqisi2
 438 007e AB71     		strb	r3, [r5, #6]
 125:tmk_core/common/action_tapping.c ****                 }
 439              		.loc 1 125 21 is_stmt 1 view .LVU115
 440              	.LVL26:
 441              	.L107:
 197:tmk_core/common/action_tapping.c ****                 }
 442              		.loc 1 197 28 is_stmt 0 view .LVU116
 443 0080 0026     		movs	r6, #0
 444              	.LVL27:
 445              	.L100:
 348:tmk_core/common/action_tapping.c **** 
 446              		.loc 1 348 1 view .LVU117
 447 0082 3046     		mov	r0, r6
 448              	.LVL28:
 348:tmk_core/common/action_tapping.c **** 
 449              		.loc 1 348 1 view .LVU118
 450 0084 05B0     		add	sp, sp, #20
 451              		.cfi_remember_state
 452              		.cfi_def_cfa_offset 28
 453              		@ sp needed
 454 0086 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 455              	.LVL29:
 456              	.L27:
 457              		.cfi_restore_state
 159:tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 458              		.loc 1 159 22 is_stmt 1 view .LVU119
 159:tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 459              		.loc 1 159 22 is_stmt 0 view .LVU120
 460 008a 8DF80010 		strb	r1, [sp]
 461 008e 8DF80120 		strb	r2, [sp, #1]
 462              	.LVL30:
 463              	.LBB92:
 464              	.LBI92:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
  49:tmk_core/common/keyboard.h **** static inline bool IS_RELEASED(keyevent_t event) { return (!IS_NOEVENT(event) && !event.pressed); }
 465              		.loc 2 49 20 is_stmt 1 view .LVU121
 466              	.LBB93:
 467              		.loc 2 49 52 view .LVU122
 468 0092 8DF80810 		strb	r1, [sp, #8]
 469 0096 8DF80920 		strb	r2, [sp, #9]
 470              	.LVL31:
 471              	.LBB94:
 472              	.LBI94:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 473              		.loc 2 47 20 view .LVU123
 474              	.LBB95:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 475              		.loc 2 47 51 view .LVU124
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 476              		.loc 2 47 74 is_stmt 0 view .LVU125
 477 009a B8F1000F 		cmp	r8, #0
 478 009e 23D0     		beq	.L30
 479              	.LVL32:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 480              		.loc 2 47 99 view .LVU126
 481 00a0 BDF80800 		ldrh	r0, [sp, #8]
 482              	.LVL33:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 483              		.loc 2 47 99 view .LVU127
 484              	.LBE95:
 485              	.LBE94:
 486              		.loc 2 49 79 view .LVU128
 487 00a4 4FF6FF73 		movw	r3, #65535
 488 00a8 9842     		cmp	r0, r3
 489 00aa 1DD0     		beq	.L30
 490 00ac F7B9     		cbnz	r7, .L31
 491              	.LVL34:
 492              		.loc 2 49 79 view .LVU129
 493              	.LBE93:
 494              	.LBE92:
 495              	.LBB96:
 496              	.LBI96:
 385:tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 497              		.loc 1 385 6 is_stmt 1 view .LVU130
 498              	.LBE96:
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 499              		.loc 1 386 5 view .LVU131
 500              	.LBB99:
 501              	.LBB97:
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 502              		.loc 1 386 10 view .LVU132
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 503              		.loc 1 386 45 is_stmt 0 view .LVU133
 504 00ae 7D48     		ldr	r0, .L115+4
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 505              		.loc 1 386 18 view .LVU134
 506 00b0 7D4B     		ldr	r3, .L115+8
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 507              		.loc 1 386 45 view .LVU135
 508 00b2 0778     		ldrb	r7, [r0]	@ zero_extendqisi2
 509              	.LVL35:
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 510              		.loc 1 386 18 view .LVU136
 511 00b4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 512              	.LVL36:
 387:tmk_core/common/action_tapping.c ****             return true;
 513              		.loc 1 387 13 view .LVU137
 514 00b6 7D48     		ldr	r0, .L115+12
 515              	.L33:
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 516              		.loc 1 386 43 is_stmt 1 view .LVU138
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 517              		.loc 1 386 5 is_stmt 0 view .LVU139
 518 00b8 BB42     		cmp	r3, r7
 519 00ba 1CD1     		bne	.L36
 520              	.LVL37:
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 521              		.loc 1 386 5 view .LVU140
 522              	.LBE97:
 523              	.LBE99:
 524              	.LBB100:
 161:tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 525              		.loc 1 161 21 is_stmt 1 view .LVU141
 161:tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 526              		.loc 1 161 39 is_stmt 0 view .LVU142
 527 00bc 0098     		ldr	r0, [sp]
 528 00be FFF7FEFF 		bl	layer_switch_get_action
 529              	.LVL38:
 162:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 530              		.loc 1 162 40 view .LVU143
 531 00c2 C0F30332 		ubfx	r2, r0, #12, #4
 162:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 532              		.loc 1 162 21 view .LVU144
 533 00c6 012A     		cmp	r2, #1
 161:tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 534              		.loc 1 161 39 view .LVU145
 535 00c8 C3B2     		uxtb	r3, r0
 536              	.LVL39:
 162:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 537              		.loc 1 162 21 is_stmt 1 view .LVU146
 538 00ca 25D9     		bls	.L56
 539 00cc 0E32     		adds	r2, r2, #14
 540 00ce 02F00F02 		and	r2, r2, #15
 541 00d2 012A     		cmp	r2, #1
 542 00d4 29D8     		bhi	.L40
 170:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 543              		.loc 1 170 29 view .LVU147
 170:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 544              		.loc 1 170 32 is_stmt 0 view .LVU148
 545 00d6 10F4706F 		tst	r0, #3840
 546 00da 22D0     		beq	.L41
 170:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 547              		.loc 1 170 68 discriminator 1 view .LVU149
 548 00dc AA79     		ldrb	r2, [r5, #6]	@ zero_extendqisi2
 170:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 549              		.loc 1 170 49 discriminator 1 view .LVU150
 550 00de 12F0F00F 		tst	r2, #240
 551 00e2 1ED1     		bne	.L41
 552              	.LVL40:
 553              	.L108:
 170:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 554              		.loc 1 170 49 discriminator 1 view .LVU151
 555              	.LBE100:
 556              	.LBB101:
 245:tmk_core/common/action_tapping.c ****             } else {
 557              		.loc 1 245 17 is_stmt 1 view .LVU152
 245:tmk_core/common/action_tapping.c ****             } else {
 558              		.loc 1 245 24 is_stmt 0 view .LVU153
 559 00e4 4E46     		mov	r6, r9
 560 00e6 CCE7     		b	.L100
 561              	.LVL41:
 562              	.L30:
 245:tmk_core/common/action_tapping.c ****             } else {
 563              		.loc 1 245 24 view .LVU154
 564              	.LBE101:
 180:tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 565              		.loc 1 180 21 is_stmt 1 view .LVU155
 180:tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 566              		.loc 1 180 24 is_stmt 0 view .LVU156
 567 00e8 002F     		cmp	r7, #0
 568 00ea C9D0     		beq	.L107
 569              	.L31:
 181:tmk_core/common/action_tapping.c **** #    if defined(HOLD_ON_OTHER_KEY_PRESS) || defined(HOLD_ON_OTHER_KEY_PRESS_PER_KEY)
 570              		.loc 1 181 25 is_stmt 1 view .LVU157
 181:tmk_core/common/action_tapping.c **** #    if defined(HOLD_ON_OTHER_KEY_PRESS) || defined(HOLD_ON_OTHER_KEY_PRESS_PER_KEY)
 571              		.loc 1 181 53 is_stmt 0 view .LVU158
 572 00ec A379     		ldrb	r3, [r4, #6]	@ zero_extendqisi2
 573 00ee 43F00103 		orr	r3, r3, #1
 574 00f2 A371     		strb	r3, [r4, #6]
 575 00f4 C4E7     		b	.L107
 576              	.LVL42:
 577              	.L36:
 578              	.LBB102:
 579              	.LBB98:
 387:tmk_core/common/action_tapping.c ****             return true;
 580              		.loc 1 387 9 is_stmt 1 view .LVU159
 387:tmk_core/common/action_tapping.c ****             return true;
 581              		.loc 1 387 13 is_stmt 0 view .LVU160
 582 00f6 00EBC304 		add	r4, r0, r3, lsl #3
 387:tmk_core/common/action_tapping.c ****             return true;
 583              		.loc 1 387 12 view .LVU161
 584 00fa 94F801C0 		ldrb	ip, [r4, #1]	@ zero_extendqisi2
 585 00fe 9445     		cmp	ip, r2
 586 0100 06D1     		bne	.L34
 387:tmk_core/common/action_tapping.c ****             return true;
 587              		.loc 1 387 13 view .LVU162
 588 0102 10F833C0 		ldrb	ip, [r0, r3, lsl #3]	@ zero_extendqisi2
 589 0106 8C45     		cmp	ip, r1
 590 0108 02D1     		bne	.L34
 387:tmk_core/common/action_tapping.c ****             return true;
 591              		.loc 1 387 59 view .LVU163
 592 010a A478     		ldrb	r4, [r4, #2]	@ zero_extendqisi2
 593 010c 002C     		cmp	r4, #0
 594 010e B7D1     		bne	.L107
 595              	.L34:
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 596              		.loc 1 386 69 is_stmt 1 view .LVU164
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 597              		.loc 1 386 76 is_stmt 0 view .LVU165
 598 0110 0133     		adds	r3, r3, #1
 599              	.LVL43:
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 600              		.loc 1 386 71 view .LVU166
 601 0112 03F00703 		and	r3, r3, #7
 602              	.LVL44:
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 603              		.loc 1 386 71 view .LVU167
 604 0116 CFE7     		b	.L33
 605              	.LVL45:
 606              	.L56:
 386:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 607              		.loc 1 386 71 view .LVU168
 608              	.LBE98:
 609              	.LBE102:
 610              	.LBB103:
 165:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 611              		.loc 1 165 29 is_stmt 1 view .LVU169
 165:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 612              		.loc 1 165 32 is_stmt 0 view .LVU170
 613 0118 10F4706F 		tst	r0, #3840
 614 011c 01D0     		beq	.L41
 165:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 615              		.loc 1 165 49 discriminator 1 view .LVU171
 616 011e 002B     		cmp	r3, #0
 617 0120 E0D0     		beq	.L108
 618              	.L41:
 171:tmk_core/common/action_tapping.c ****                             break;
 619              		.loc 1 171 29 is_stmt 1 view .LVU172
 171:tmk_core/common/action_tapping.c ****                             break;
 620              		.loc 1 171 33 is_stmt 0 view .LVU173
 621 0122 2033     		adds	r3, r3, #32
 622              	.LVL46:
 171:tmk_core/common/action_tapping.c ****                             break;
 623              		.loc 1 171 32 view .LVU174
 624 0124 DBB2     		uxtb	r3, r3
 625              	.LVL47:
 171:tmk_core/common/action_tapping.c ****                             break;
 626              		.loc 1 171 32 view .LVU175
 627 0126 072B     		cmp	r3, #7
 628 0128 DCD9     		bls	.L108
 629              	.L40:
 175:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 630              		.loc 1 175 86 is_stmt 1 view .LVU176
 176:tmk_core/common/action_tapping.c ****                     return true;
 631              		.loc 1 176 21 view .LVU177
 632 012a 2846     		mov	r0, r5
 633              	.LVL48:
 176:tmk_core/common/action_tapping.c ****                     return true;
 634              		.loc 1 176 21 is_stmt 0 view .LVU178
 635 012c FFF7FEFF 		bl	process_record
 636              	.LVL49:
 177:tmk_core/common/action_tapping.c ****                 } else {
 637              		.loc 1 177 21 is_stmt 1 view .LVU179
 177:tmk_core/common/action_tapping.c ****                 } else {
 638              		.loc 1 177 28 is_stmt 0 view .LVU180
 639 0130 B146     		mov	r9, r6
 640              	.LVL50:
 177:tmk_core/common/action_tapping.c ****                 } else {
 641              		.loc 1 177 28 view .LVU181
 642 0132 D7E7     		b	.L108
 643              	.LVL51:
 644              	.L26:
 177:tmk_core/common/action_tapping.c ****                 } else {
 645              		.loc 1 177 28 view .LVU182
 646              	.LBE103:
 202:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 647              		.loc 1 202 17 is_stmt 1 view .LVU183
 648              	.LBB104:
 649              	.LBI104:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 650              		.loc 2 47 20 view .LVU184
 651              	.LBB105:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 652              		.loc 2 47 51 view .LVU185
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 653              		.loc 2 47 51 is_stmt 0 view .LVU186
 654              	.LBE105:
 655              	.LBE104:
 202:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 656              		.loc 1 202 21 view .LVU187
 657 0134 7345     		cmp	r3, lr
 658 0136 0BD1     		bne	.L42
 202:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 659              		.loc 1 202 45 discriminator 2 view .LVU188
 660 0138 57B9     		cbnz	r7, .L42
 203:tmk_core/common/action_tapping.c ****                     debug_dec(tapping_key.tap.count);
 661              		.loc 1 203 51 is_stmt 1 view .LVU189
 204:tmk_core/common/action_tapping.c ****                     debug(")\n");
 662              		.loc 1 204 53 view .LVU190
 205:tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 663              		.loc 1 205 33 view .LVU191
 206:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 664              		.loc 1 206 21 view .LVU192
 206:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 665              		.loc 1 206 31 is_stmt 0 view .LVU193
 666 013a A871     		strb	r0, [r5, #6]
 207:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 667              		.loc 1 207 21 is_stmt 1 view .LVU194
 668              	.LVL52:
 669              	.L55:
 292:tmk_core/common/action_tapping.c ****                         debug_dec(keyp->tap.count);
 670              		.loc 1 292 53 view .LVU195
 293:tmk_core/common/action_tapping.c ****                         debug(")\n");
 671              		.loc 1 293 51 view .LVU196
 294:tmk_core/common/action_tapping.c ****                         process_record(keyp);
 672              		.loc 1 294 37 view .LVU197
 295:tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 673              		.loc 1 295 25 view .LVU198
 674 013c 2846     		mov	r0, r5
 675 013e FFF7FEFF 		bl	process_record
 676              	.LVL53:
 296:tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 677              		.loc 1 296 25 view .LVU199
 296:tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 678              		.loc 1 296 37 is_stmt 0 view .LVU200
 679 0142 2B68     		ldr	r3, [r5]	@ unaligned
 680 0144 2360     		str	r3, [r4]	@ unaligned
 681 0146 6B68     		ldr	r3, [r5, #4]	@ unaligned
 682 0148 6360     		str	r3, [r4, #4]	@ unaligned
 297:tmk_core/common/action_tapping.c ****                         return true;
 683              		.loc 1 297 25 is_stmt 1 view .LVU201
 684              	.LVL54:
 685              	.L106:
 341:tmk_core/common/action_tapping.c ****             return true;
 686              		.loc 1 341 13 view .LVU202
 687 014a FFF7FEFF 		bl	debug_tapping_key
 688              	.LVL55:
 342:tmk_core/common/action_tapping.c ****         } else {
 689              		.loc 1 342 13 view .LVU203
 342:tmk_core/common/action_tapping.c ****         } else {
 690              		.loc 1 342 20 is_stmt 0 view .LVU204
 691 014e 98E7     		b	.L100
 692              	.LVL56:
 693              	.L42:
 211:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 694              		.loc 1 211 24 is_stmt 1 view .LVU205
 211:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 695              		.loc 1 211 28 is_stmt 0 view .LVU206
 696 0150 2846     		mov	r0, r5
 697 0152 FFF7FEFF 		bl	is_tap_record
 698              	.LVL57:
 211:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 699              		.loc 1 211 27 view .LVU207
 700 0156 D0B1     		cbz	r0, .L52
 211:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 701              		.loc 1 211 48 discriminator 1 view .LVU208
 702 0158 CFB1     		cbz	r7, .L52
 212:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 703              		.loc 1 212 21 is_stmt 1 view .LVU209
 212:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 704              		.loc 1 212 40 is_stmt 0 view .LVU210
 705 015a A379     		ldrb	r3, [r4, #6]	@ zero_extendqisi2
 212:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 706              		.loc 1 212 24 view .LVU211
 707 015c 1F2B     		cmp	r3, #31
 708 015e 0CD9     		bls	.L45
 709              	.LBB106:
 213:tmk_core/common/action_tapping.c ****                         // unregister key
 710              		.loc 1 213 87 is_stmt 1 view .LVU212
 215:tmk_core/common/action_tapping.c **** #ifdef COMBO_ENABLE
 711              		.loc 1 215 25 view .LVU213
 215:tmk_core/common/action_tapping.c **** #ifdef COMBO_ENABLE
 712              		.loc 1 215 54 is_stmt 0 view .LVU214
 713 0160 2288     		ldrh	r2, [r4]
 714 0162 ADF80820 		strh	r2, [sp, #8]	@ movhi
 215:tmk_core/common/action_tapping.c **** #ifdef COMBO_ENABLE
 715              		.loc 1 215 25 view .LVU215
 716 0166 02A8     		add	r0, sp, #8
 215:tmk_core/common/action_tapping.c **** #ifdef COMBO_ENABLE
 717              		.loc 1 215 54 view .LVU216
 718 0168 0022     		movs	r2, #0
 719 016a 8DF80A20 		strb	r2, [sp, #10]
 720 016e ADF80C80 		strh	r8, [sp, #12]	@ movhi
 721 0172 8DF80E30 		strb	r3, [sp, #14]
 215:tmk_core/common/action_tapping.c **** #ifdef COMBO_ENABLE
 722              		.loc 1 215 25 view .LVU217
 723 0176 FFF7FEFF 		bl	process_record
 724              	.LVL58:
 725              	.L45:
 215:tmk_core/common/action_tapping.c **** #ifdef COMBO_ENABLE
 726              		.loc 1 215 25 view .LVU218
 727              	.LBE106:
 221:tmk_core/common/action_tapping.c ****                     }
 728              		.loc 1 221 69 is_stmt 1 view .LVU219
 223:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 729              		.loc 1 223 21 view .LVU220
 223:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 730              		.loc 1 223 33 is_stmt 0 view .LVU221
 731 017a 2B68     		ldr	r3, [r5]	@ unaligned
 732 017c 2360     		str	r3, [r4]	@ unaligned
 733 017e 6B68     		ldr	r3, [r5, #4]	@ unaligned
 734 0180 6360     		str	r3, [r4, #4]	@ unaligned
 224:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 735              		.loc 1 224 21 is_stmt 1 view .LVU222
 736 0182 FFF7FEFF 		bl	waiting_buffer_scan_tap
 737              	.LVL59:
 225:tmk_core/common/action_tapping.c ****                     return true;
 738              		.loc 1 225 21 view .LVU223
 739 0186 FFF7FEFF 		bl	debug_tapping_key
 740              	.LVL60:
 226:tmk_core/common/action_tapping.c ****                 } else {
 741              		.loc 1 226 21 view .LVU224
 742              	.L109:
 232:tmk_core/common/action_tapping.c ****                 }
 743              		.loc 1 232 21 view .LVU225
 232:tmk_core/common/action_tapping.c ****                 }
 744              		.loc 1 232 28 is_stmt 0 view .LVU226
 745 018a 0126     		movs	r6, #1
 746 018c 79E7     		b	.L100
 747              	.L52:
 228:tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 748              		.loc 1 228 21 is_stmt 1 view .LVU227
 749              	.LVL61:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 750              		.loc 2 47 51 view .LVU228
 229:tmk_core/common/action_tapping.c ****                     }
 751              		.loc 1 229 74 view .LVU229
 231:tmk_core/common/action_tapping.c ****                     return true;
 752              		.loc 1 231 21 view .LVU230
 753 018e 2846     		mov	r0, r5
 754 0190 FFF7FEFF 		bl	process_record
 755              	.LVL62:
 756 0194 F9E7     		b	.L109
 757              	.LVL63:
 758              	.L25:
 238:tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 759              		.loc 1 238 13 view .LVU231
 238:tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 760              		.loc 1 238 16 is_stmt 0 view .LVU232
 761 0196 B9F1000F 		cmp	r9, #0
 762 019a 13D1     		bne	.L46
 763              	.LBB107:
 239:tmk_core/common/action_tapping.c ****                 debug_event(event);
 764              		.loc 1 239 61 is_stmt 1 view .LVU233
 240:tmk_core/common/action_tapping.c ****                 debug("\n");
 765              		.loc 1 240 17 view .LVU234
 240:tmk_core/common/action_tapping.c ****                 debug("\n");
 766              		.loc 1 240 17 is_stmt 0 view .LVU235
 767 019c 8DF80120 		strb	r2, [sp, #1]
 768 01a0 8DF80010 		strb	r1, [sp]
 769 01a4 8DF80270 		strb	r7, [sp, #2]
 770 01a8 9CE80300 		ldm	ip, {r0, r1}
 771              	.LVL64:
 240:tmk_core/common/action_tapping.c ****                 debug("\n");
 772              		.loc 1 240 17 view .LVU236
 773 01ac FFF7FEFF 		bl	debug_event
 774              	.LVL65:
 241:tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 775              		.loc 1 241 28 is_stmt 1 view .LVU237
 242:tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 776              		.loc 1 242 17 view .LVU238
 777 01b0 2046     		mov	r0, r4
 778 01b2 FFF7FEFF 		bl	process_record
 779              	.LVL66:
 243:tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 780              		.loc 1 243 17 view .LVU239
 243:tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 781              		.loc 1 243 29 is_stmt 0 view .LVU240
 782 01b6 C4F80090 		str	r9, [r4]	@ unaligned
 783 01ba C4F80490 		str	r9, [r4, #4]	@ unaligned
 244:tmk_core/common/action_tapping.c ****                 return false;
 784              		.loc 1 244 17 is_stmt 1 view .LVU241
 785 01be FFF7FEFF 		bl	debug_tapping_key
 786              	.LVL67:
 787 01c2 8FE7     		b	.L108
 788              	.LVL68:
 789              	.L46:
 244:tmk_core/common/action_tapping.c ****                 return false;
 790              		.loc 1 244 17 is_stmt 0 view .LVU242
 791              	.LBE107:
 247:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 792              		.loc 1 247 17 is_stmt 1 view .LVU243
 793              	.LBB108:
 794              	.LBI108:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 795              		.loc 2 47 20 view .LVU244
 796              	.LBB109:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 797              		.loc 2 47 51 view .LVU245
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 798              		.loc 2 47 51 is_stmt 0 view .LVU246
 799              	.LBE109:
 800              	.LBE108:
 247:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 801              		.loc 1 247 21 view .LVU247
 802 01c4 2288     		ldrh	r2, [r4]
 803              	.LVL69:
 247:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 804              		.loc 1 247 21 view .LVU248
 805 01c6 2B88     		ldrh	r3, [r5]
 806 01c8 9A42     		cmp	r2, r3
 807 01ca C1D1     		bne	.L42
 247:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 808              		.loc 1 247 45 discriminator 2 view .LVU249
 809 01cc 002F     		cmp	r7, #0
 810 01ce BFD1     		bne	.L42
 811              	.LBB110:
 248:tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 812              		.loc 1 248 73 is_stmt 1 view .LVU250
 249:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 813              		.loc 1 249 21 view .LVU251
 249:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 814              		.loc 1 249 31 is_stmt 0 view .LVU252
 815 01d0 A871     		strb	r0, [r5, #6]
 250:tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 816              		.loc 1 250 21 is_stmt 1 view .LVU253
 817 01d2 2846     		mov	r0, r5
 818 01d4 FFF7FEFF 		bl	process_record
 819              	.LVL70:
 251:tmk_core/common/action_tapping.c ****                     return true;
 820              		.loc 1 251 21 view .LVU254
 251:tmk_core/common/action_tapping.c ****                     return true;
 821              		.loc 1 251 33 is_stmt 0 view .LVU255
 822 01d8 2760     		str	r7, [r4]	@ unaligned
 823 01da 6760     		str	r7, [r4, #4]	@ unaligned
 252:tmk_core/common/action_tapping.c ****                 } else if (is_tap_record(keyp) && event.pressed) {
 824              		.loc 1 252 21 is_stmt 1 view .LVU256
 825 01dc 51E7     		b	.L100
 826              	.LVL71:
 827              	.L24:
 252:tmk_core/common/action_tapping.c ****                 } else if (is_tap_record(keyp) && event.pressed) {
 828              		.loc 1 252 21 is_stmt 0 view .LVU257
 829              	.LBE110:
 278:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 830              		.loc 1 278 12 is_stmt 1 view .LVU258
 831 01de 2068     		ldr	r0, [r4]	@ unaligned
 832 01e0 0290     		str	r0, [sp, #8]
 833 01e2 A088     		ldrh	r0, [r4, #4]	@ unaligned
 834 01e4 ADF80C00 		strh	r0, [sp, #12]	@ unaligned
 835              	.LVL72:
 836              	.LBB111:
 837              	.LBI111:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 838              		.loc 2 47 20 view .LVU259
 839              	.LBB112:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 840              		.loc 2 47 51 view .LVU260
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 841              		.loc 2 47 74 is_stmt 0 view .LVU261
 842 01e8 002B     		cmp	r3, #0
 843 01ea 46D0     		beq	.L50
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 844              		.loc 2 47 99 view .LVU262
 845 01ec BDF80860 		ldrh	r6, [sp, #8]
 846              	.LVL73:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 847              		.loc 2 47 99 view .LVU263
 848              	.LBE112:
 849              	.LBE111:
 278:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 850              		.loc 1 278 15 view .LVU264
 851 01f0 4FF6FF70 		movw	r0, #65535
 852 01f4 8642     		cmp	r6, r0
 853 01f6 40D0     		beq	.L50
 278:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 854              		.loc 1 278 16 discriminator 1 view .LVU265
 855 01f8 A678     		ldrb	r6, [r4, #2]	@ zero_extendqisi2
 856 01fa 002E     		cmp	r6, #0
 857 01fc 3DD1     		bne	.L50
 279:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 858              		.loc 1 279 9 is_stmt 1 view .LVU266
 279:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 859              		.loc 1 279 13 is_stmt 0 view .LVU267
 860 01fe A8EB0308 		sub	r8, r8, r3
 861              	.LVL74:
 279:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 862              		.loc 1 279 12 view .LVU268
 863 0202 1FFA88F8 		uxth	r8, r8
 864 0206 B8F1B30F 		cmp	r8, #179
 865 020a 29D8     		bhi	.L51
 280:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_RECORD(keyp)) {
 866              		.loc 1 280 13 is_stmt 1 view .LVU269
 280:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_RECORD(keyp)) {
 867              		.loc 1 280 16 is_stmt 0 view .LVU270
 868 020c 3E46     		mov	r6, r7
 869 020e 002F     		cmp	r7, #0
 870 0210 BDD0     		beq	.L52
 871              	.LVL75:
 281:tmk_core/common/action_tapping.c **** //#    ifndef TAPPING_FORCE_HOLD
 872              		.loc 1 281 17 is_stmt 1 view .LVU271
 873              	.LBB113:
 874              	.LBI113:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 875              		.loc 2 47 20 view .LVU272
 876              	.LBB114:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 877              		.loc 2 47 51 view .LVU273
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 878              		.loc 2 47 51 is_stmt 0 view .LVU274
 879              	.LBE114:
 880              	.LBE113:
 281:tmk_core/common/action_tapping.c **** //#    ifndef TAPPING_FORCE_HOLD
 881              		.loc 1 281 21 view .LVU275
 882 0212 2288     		ldrh	r2, [r4]
 883              	.LVL76:
 281:tmk_core/common/action_tapping.c **** //#    ifndef TAPPING_FORCE_HOLD
 884              		.loc 1 281 21 view .LVU276
 885 0214 2B88     		ldrh	r3, [r5]
 886 0216 9A42     		cmp	r2, r3
 887 0218 15D1     		bne	.L53
 284:tmk_core/common/action_tapping.c **** #        ifdef TAPPING_FORCE_HOLD_PER_KEY
 888              		.loc 1 284 21 is_stmt 1 view .LVU277
 288:tmk_core/common/action_tapping.c ****                         // sequential tap.
 889              		.loc 1 288 41 is_stmt 0 view .LVU278
 890 021a A379     		ldrb	r3, [r4, #6]	@ zero_extendqisi2
 284:tmk_core/common/action_tapping.c **** #        ifdef TAPPING_FORCE_HOLD_PER_KEY
 891              		.loc 1 284 24 view .LVU279
 892 021c DA07     		lsls	r2, r3, #31
 893 021e 0DD4     		bmi	.L54
 288:tmk_core/common/action_tapping.c ****                         // sequential tap.
 894              		.loc 1 288 54 view .LVU280
 895 0220 13F0F002 		ands	r2, r3, #240
 896 0224 0AD0     		beq	.L54
 290:tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 897              		.loc 1 290 25 is_stmt 1 view .LVU281
 291:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 898              		.loc 1 291 28 is_stmt 0 view .LVU282
 899 0226 F02A     		cmp	r2, #240
 290:tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 900              		.loc 1 290 35 view .LVU283
 901 0228 AB71     		strb	r3, [r5, #6]
 291:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 902              		.loc 1 291 25 is_stmt 1 view .LVU284
 291:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 903              		.loc 1 291 28 is_stmt 0 view .LVU285
 904 022a 87D0     		beq	.L55
 291:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 905              		.loc 1 291 51 is_stmt 1 discriminator 1 view .LVU286
 291:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 906              		.loc 1 291 67 is_stmt 0 discriminator 1 view .LVU287
 907 022c DBB2     		uxtb	r3, r3
 908 022e C3F30312 		ubfx	r2, r3, #4, #4
 909 0232 0132     		adds	r2, r2, #1
 910 0234 62F30713 		bfi	r3, r2, #4, #4
 911 0238 AB71     		strb	r3, [r5, #6]
 912 023a 7FE7     		b	.L55
 913              	.L54:
 302:tmk_core/common/action_tapping.c ****                     return true;
 914              		.loc 1 302 21 is_stmt 1 view .LVU288
 302:tmk_core/common/action_tapping.c ****                     return true;
 915              		.loc 1 302 33 is_stmt 0 view .LVU289
 916 023c 2B68     		ldr	r3, [r5]	@ unaligned
 917 023e 2360     		str	r3, [r4]	@ unaligned
 918              	.LVL77:
 302:tmk_core/common/action_tapping.c ****                     return true;
 919              		.loc 1 302 33 view .LVU290
 920 0240 6B68     		ldr	r3, [r5, #4]	@ unaligned
 921 0242 6360     		str	r3, [r4, #4]	@ unaligned
 303:tmk_core/common/action_tapping.c ****                 } else if (is_tap_record(keyp)) {
 922              		.loc 1 303 21 is_stmt 1 view .LVU291
 303:tmk_core/common/action_tapping.c ****                 } else if (is_tap_record(keyp)) {
 923              		.loc 1 303 28 is_stmt 0 view .LVU292
 924 0244 1DE7     		b	.L100
 925              	.LVL78:
 926              	.L53:
 304:tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 927              		.loc 1 304 24 is_stmt 1 view .LVU293
 304:tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 928              		.loc 1 304 28 is_stmt 0 view .LVU294
 929 0246 2846     		mov	r0, r5
 930 0248 FFF7FEFF 		bl	is_tap_record
 931              	.LVL79:
 304:tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 932              		.loc 1 304 27 view .LVU295
 933 024c 0028     		cmp	r0, #0
 934 024e 94D1     		bne	.L45
 314:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 935              		.loc 1 314 21 is_stmt 1 view .LVU296
 314:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 936              		.loc 1 314 49 is_stmt 0 view .LVU297
 937 0250 A379     		ldrb	r3, [r4, #6]	@ zero_extendqisi2
 315:tmk_core/common/action_tapping.c ****                     return true;
 938              		.loc 1 315 21 view .LVU298
 939 0252 2846     		mov	r0, r5
 314:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 940              		.loc 1 314 49 view .LVU299
 941 0254 43F00103 		orr	r3, r3, #1
 942 0258 A371     		strb	r3, [r4, #6]
 315:tmk_core/common/action_tapping.c ****                     return true;
 943              		.loc 1 315 21 is_stmt 1 view .LVU300
 944 025a FFF7FEFF 		bl	process_record
 945              	.LVL80:
 316:tmk_core/common/action_tapping.c ****                 }
 946              		.loc 1 316 21 view .LVU301
 316:tmk_core/common/action_tapping.c ****                 }
 947              		.loc 1 316 28 is_stmt 0 view .LVU302
 948 025e 10E7     		b	.L100
 949              	.LVL81:
 950              	.L51:
 951              	.LBB115:
 326:tmk_core/common/action_tapping.c ****             debug_event(event);
 952              		.loc 1 326 70 is_stmt 1 view .LVU303
 327:tmk_core/common/action_tapping.c ****             debug("\n");
 953              		.loc 1 327 13 view .LVU304
 327:tmk_core/common/action_tapping.c ****             debug("\n");
 954              		.loc 1 327 13 is_stmt 0 view .LVU305
 955 0260 8DF80010 		strb	r1, [sp]
 956 0264 8DF80120 		strb	r2, [sp, #1]
 957 0268 8DF80270 		strb	r7, [sp, #2]
 958 026c 9CE80300 		ldm	ip, {r0, r1}
 959              	.LVL82:
 327:tmk_core/common/action_tapping.c ****             debug("\n");
 960              		.loc 1 327 13 view .LVU306
 961 0270 FFF7FEFF 		bl	debug_event
 962              	.LVL83:
 328:tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 963              		.loc 1 328 24 is_stmt 1 view .LVU307
 329:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 964              		.loc 1 329 13 view .LVU308
 329:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 965              		.loc 1 329 25 is_stmt 0 view .LVU309
 966 0274 2660     		str	r6, [r4]	@ unaligned
 967 0276 6660     		str	r6, [r4, #4]	@ unaligned
 330:tmk_core/common/action_tapping.c ****             return false;
 968              		.loc 1 330 13 is_stmt 1 view .LVU310
 969 0278 67E7     		b	.L106
 970              	.LVL84:
 971              	.L50:
 330:tmk_core/common/action_tapping.c ****             return false;
 972              		.loc 1 330 13 is_stmt 0 view .LVU311
 973              	.LBE115:
 336:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 974              		.loc 1 336 9 is_stmt 1 view .LVU312
 336:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 975              		.loc 1 336 12 is_stmt 0 view .LVU313
 976 027a 002F     		cmp	r7, #0
 977 027c 87D0     		beq	.L52
 336:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 978              		.loc 1 336 30 discriminator 1 view .LVU314
 979 027e 2846     		mov	r0, r5
 980 0280 FFF7FEFF 		bl	is_tap_record
 981              	.LVL85:
 336:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 982              		.loc 1 336 27 discriminator 1 view .LVU315
 983 0284 0646     		mov	r6, r0
 984 0286 0028     		cmp	r0, #0
 985 0288 81D0     		beq	.L52
 337:tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 986              		.loc 1 337 54 is_stmt 1 view .LVU316
 338:tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 987              		.loc 1 338 13 view .LVU317
 338:tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 988              		.loc 1 338 25 is_stmt 0 view .LVU318
 989 028a 2B68     		ldr	r3, [r5]	@ unaligned
 990 028c 2360     		str	r3, [r4]	@ unaligned
 991 028e 6B68     		ldr	r3, [r5, #4]	@ unaligned
 339:tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 992              		.loc 1 339 13 view .LVU319
 993 0290 0348     		ldr	r0, .L115
 338:tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 994              		.loc 1 338 25 view .LVU320
 995 0292 6360     		str	r3, [r4, #4]	@ unaligned
 339:tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 996              		.loc 1 339 13 is_stmt 1 view .LVU321
 997 0294 FFF7FEFF 		bl	process_record_tap_hint
 998              	.LVL86:
 340:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 999              		.loc 1 340 13 view .LVU322
 1000 0298 FFF7FEFF 		bl	waiting_buffer_scan_tap
 1001              	.LVL87:
 1002 029c 55E7     		b	.L106
 1003              	.L116:
 1004 029e 00BF     		.align	2
 1005              	.L115:
 1006 02a0 00000000 		.word	.LANCHOR3
 1007 02a4 00000000 		.word	.LANCHOR2
 1008 02a8 00000000 		.word	.LANCHOR0
 1009 02ac 00000000 		.word	.LANCHOR1
 1010              		.cfi_endproc
 1011              	.LFE7:
 1013              		.section	.text.get_tapping_term,"ax",%progbits
 1014              		.align	1
 1015              		.weak	get_tapping_term
 1016              		.syntax unified
 1017              		.thumb
 1018              		.thumb_func
 1019              		.fpu fpv4-sp-d16
 1021              	get_tapping_term:
 1022              	.LVL88:
 1023              	.LFB5:
  27:tmk_core/common/action_tapping.c **** 
 1024              		.loc 1 27 88 view -0
 1025              		.cfi_startproc
 1026              		@ args = 0, pretend = 0, frame = 0
 1027              		@ frame_needed = 0, uses_anonymous_args = 0
 1028              		@ link register save eliminated.
  27:tmk_core/common/action_tapping.c **** 
 1029              		.loc 1 27 90 view .LVU324
  27:tmk_core/common/action_tapping.c **** 
 1030              		.loc 1 27 111 is_stmt 0 view .LVU325
 1031 0000 B420     		movs	r0, #180
 1032              	.LVL89:
  27:tmk_core/common/action_tapping.c **** 
 1033              		.loc 1 27 111 view .LVU326
 1034 0002 7047     		bx	lr
 1035              		.cfi_endproc
 1036              	.LFE5:
 1038              		.section	.text.action_tapping_process,"ax",%progbits
 1039              		.align	1
 1040              		.global	action_tapping_process
 1041              		.syntax unified
 1042              		.thumb
 1043              		.thumb_func
 1044              		.fpu fpv4-sp-d16
 1046              	action_tapping_process:
 1047              	.LFB6:
  65:tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
 1048              		.loc 1 65 49 is_stmt 1 view -0
 1049              		.cfi_startproc
 1050              		@ args = 0, pretend = 0, frame = 24
 1051              		@ frame_needed = 0, uses_anonymous_args = 0
  66:tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1052              		.loc 1 66 5 view .LVU328
  65:tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
 1053              		.loc 1 65 49 is_stmt 0 view .LVU329
 1054 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 1055              		.cfi_def_cfa_offset 20
 1056              		.cfi_offset 4, -20
 1057              		.cfi_offset 5, -16
 1058              		.cfi_offset 6, -12
 1059              		.cfi_offset 7, -8
 1060              		.cfi_offset 14, -4
 1061 0002 87B0     		sub	sp, sp, #28
 1062              		.cfi_def_cfa_offset 48
  65:tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
 1063              		.loc 1 65 49 view .LVU330
 1064 0004 6C46     		mov	r4, sp
 1065 0006 84E80300 		stm	r4, {r0, r1}
  66:tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1066              		.loc 1 66 9 view .LVU331
 1067 000a 2046     		mov	r0, r4
 1068 000c FFF7FEFF 		bl	process_tapping
 1069              	.LVL90:
 1070 0010 2B4F     		ldr	r7, .L130
 1071 0012 BDF80420 		ldrh	r2, [sp, #4]
 1072 0016 2B4E     		ldr	r6, .L130+4
  66:tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1073              		.loc 1 66 8 view .LVU332
 1074 0018 0546     		mov	r5, r0
 1075 001a 78B1     		cbz	r0, .L119
  67:tmk_core/common/action_tapping.c ****             debug("processed: ");
 1076              		.loc 1 67 9 is_stmt 1 view .LVU333
 1077 001c 94E80300 		ldm	r4, {r0, r1}
 1078 0020 0490     		str	r0, [sp, #16]
 1079 0022 ADF81410 		strh	r1, [sp, #20]	@ movhi
 1080              	.LVL91:
 1081              	.LBB125:
 1082              	.LBI125:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1083              		.loc 2 47 20 view .LVU334
 1084              	.LBB126:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1085              		.loc 2 47 51 view .LVU335
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1086              		.loc 2 47 74 is_stmt 0 view .LVU336
 1087 0026 3AB1     		cbz	r2, .L121
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1088              		.loc 2 47 99 view .LVU337
 1089 0028 BDF81020 		ldrh	r2, [sp, #16]
 1090              	.LVL92:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1091              		.loc 2 47 99 view .LVU338
 1092              	.LBE126:
 1093              	.LBE125:
  67:tmk_core/common/action_tapping.c ****             debug("processed: ");
 1094              		.loc 1 67 12 view .LVU339
 1095 002c 4FF6FF73 		movw	r3, #65535
 1096 0030 9A42     		cmp	r2, r3
 1097 0032 01D0     		beq	.L121
  68:tmk_core/common/action_tapping.c ****             debug_record(record);
 1098              		.loc 1 68 33 is_stmt 1 view .LVU340
  69:tmk_core/common/action_tapping.c ****             debug("\n");
 1099              		.loc 1 69 13 view .LVU341
 1100 0034 FFF7FEFF 		bl	debug_record
 1101              	.LVL93:
 1102              	.L121:
  87:tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer[");
 1103              		.loc 1 87 13 is_stmt 0 discriminator 1 view .LVU342
 1104 0038 234C     		ldr	r4, .L130+8
 1105 003a 3AE0     		b	.L127
 1106              	.L119:
  73:tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
 1107              		.loc 1 73 9 is_stmt 1 view .LVU343
 1108 003c 94E80300 		ldm	r4, {r0, r1}
 1109 0040 04AB     		add	r3, sp, #16
 1110 0042 83E80300 		stm	r3, {r0, r1}
 1111              	.LVL94:
 1112              	.LBB127:
 1113              	.LBI127:
 354:tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 1114              		.loc 1 354 6 view .LVU344
 1115              	.LBB128:
 355:tmk_core/common/action_tapping.c ****         return true;
 1116              		.loc 1 355 5 view .LVU345
 1117 0046 0290     		str	r0, [sp, #8]
 1118              	.LVL95:
 1119              	.LBB129:
 1120              	.LBI129:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1121              		.loc 2 47 20 view .LVU346
 1122              	.LBB130:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1123              		.loc 2 47 51 view .LVU347
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1124              		.loc 2 47 74 is_stmt 0 view .LVU348
 1125 0048 002A     		cmp	r2, #0
 1126 004a F5D0     		beq	.L121
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1127              		.loc 2 47 99 view .LVU349
 1128 004c BDF80800 		ldrh	r0, [sp, #8]
 1129              	.LVL96:
  47:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1130              		.loc 2 47 99 view .LVU350
 1131              	.LBE130:
 1132              	.LBE129:
 359:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1133              		.loc 1 359 30 view .LVU351
 1134 0050 3C78     		ldrb	r4, [r7]	@ zero_extendqisi2
 359:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1135              		.loc 1 359 57 view .LVU352
 1136 0052 3178     		ldrb	r1, [r6]	@ zero_extendqisi2
 355:tmk_core/common/action_tapping.c ****         return true;
 1137              		.loc 1 355 8 view .LVU353
 1138 0054 4FF6FF72 		movw	r2, #65535
 1139              	.LVL97:
 355:tmk_core/common/action_tapping.c ****         return true;
 1140              		.loc 1 355 8 view .LVU354
 1141 0058 9042     		cmp	r0, r2
 1142 005a EDD0     		beq	.L121
 359:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1143              		.loc 1 359 5 is_stmt 1 view .LVU355
 359:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1144              		.loc 1 359 30 is_stmt 0 view .LVU356
 1145 005c 621C     		adds	r2, r4, #1
 359:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1146              		.loc 1 359 35 view .LVU357
 1147 005e 02F00702 		and	r2, r2, #7
 359:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1148              		.loc 1 359 8 view .LVU358
 1149 0062 8A42     		cmp	r2, r1
 1150 0064 0BD0     		beq	.L125
 364:tmk_core/common/action_tapping.c ****     waiting_buffer_head                 = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1151              		.loc 1 364 5 is_stmt 1 view .LVU359
 364:tmk_core/common/action_tapping.c ****     waiting_buffer_head                 = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1152              		.loc 1 364 41 is_stmt 0 view .LVU360
 1153 0066 184D     		ldr	r5, .L130+8
 365:tmk_core/common/action_tapping.c **** 
 1154              		.loc 1 365 41 view .LVU361
 1155 0068 3A70     		strb	r2, [r7]
 364:tmk_core/common/action_tapping.c ****     waiting_buffer_head                 = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1156              		.loc 1 364 41 view .LVU362
 1157 006a 03CB     		ldmia	r3!, {r0, r1}
 1158 006c 05EBC40C 		add	ip, r5, r4, lsl #3
 1159 0070 45F83400 		str	r0, [r5, r4, lsl #3]	@ unaligned
 1160 0074 CCF80410 		str	r1, [ip, #4]	@ unaligned
 365:tmk_core/common/action_tapping.c **** 
 1161              		.loc 1 365 5 is_stmt 1 view .LVU363
 367:tmk_core/common/action_tapping.c ****     debug_waiting_buffer();
 1162              		.loc 1 367 34 view .LVU364
 368:tmk_core/common/action_tapping.c ****     return true;
 1163              		.loc 1 368 5 view .LVU365
 1164 0078 FFF7FEFF 		bl	debug_waiting_buffer
 1165              	.LVL98:
 369:tmk_core/common/action_tapping.c **** }
 1166              		.loc 1 369 5 view .LVU366
 369:tmk_core/common/action_tapping.c **** }
 1167              		.loc 1 369 5 is_stmt 0 view .LVU367
 1168 007c DCE7     		b	.L121
 1169              	.L125:
 369:tmk_core/common/action_tapping.c **** }
 1170              		.loc 1 369 5 view .LVU368
 1171              	.LBE128:
 1172              	.LBE127:
 1173              	.LBB131:
  75:tmk_core/common/action_tapping.c ****             clear_keyboard();
 1174              		.loc 1 75 50 is_stmt 1 view .LVU369
  76:tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
 1175              		.loc 1 76 13 view .LVU370
 1176 007e FFF7FEFF 		bl	clear_keyboard
 1177              	.LVL99:
  77:tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1178              		.loc 1 77 13 view .LVU371
 1179              	.LBB132:
 1180              	.LBI132:
 376:tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 1181              		.loc 1 376 6 view .LVU372
 1182              	.LBB133:
 377:tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1183              		.loc 1 377 5 view .LVU373
 1184              	.LBE133:
 1185              	.LBE132:
  78:tmk_core/common/action_tapping.c ****         }
 1186              		.loc 1 78 25 is_stmt 0 view .LVU374
 1187 0082 124B     		ldr	r3, .L130+12
 1188              	.LBB135:
 1189              	.LBB134:
 377:tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1190              		.loc 1 377 25 view .LVU375
 1191 0084 3D70     		strb	r5, [r7]
 378:tmk_core/common/action_tapping.c **** }
 1192              		.loc 1 378 5 is_stmt 1 view .LVU376
 378:tmk_core/common/action_tapping.c **** }
 1193              		.loc 1 378 25 is_stmt 0 view .LVU377
 1194 0086 3570     		strb	r5, [r6]
 1195              	.LBE134:
 1196              	.LBE135:
  78:tmk_core/common/action_tapping.c ****         }
 1197              		.loc 1 78 13 is_stmt 1 view .LVU378
  78:tmk_core/common/action_tapping.c ****         }
 1198              		.loc 1 78 25 is_stmt 0 view .LVU379
 1199 0088 1D60     		str	r5, [r3]	@ unaligned
 1200 008a 5D60     		str	r5, [r3, #4]	@ unaligned
 1201 008c D4E7     		b	.L121
 1202              	.L128:
 1203              	.LBE131:
  87:tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer[");
 1204              		.loc 1 87 9 is_stmt 1 view .LVU380
  87:tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer[");
 1205              		.loc 1 87 13 is_stmt 0 view .LVU381
 1206 008e 04EBC000 		add	r0, r4, r0, lsl #3
 1207 0092 FFF7FEFF 		bl	process_tapping
 1208              	.LVL100:
  87:tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer[");
 1209              		.loc 1 87 12 view .LVU382
 1210 0096 80B1     		cbz	r0, .L118
  88:tmk_core/common/action_tapping.c ****             debug_dec(waiting_buffer_tail);
 1211              		.loc 1 88 48 is_stmt 1 view .LVU383
  89:tmk_core/common/action_tapping.c ****             debug("] = ");
 1212              		.loc 1 89 43 view .LVU384
  90:tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]);
 1213              		.loc 1 90 26 view .LVU385
  91:tmk_core/common/action_tapping.c ****             debug("\n\n");
 1214              		.loc 1 91 13 view .LVU386
 1215 0098 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 1216 009a 04EBC302 		add	r2, r4, r3, lsl #3
 1217 009e 54F83300 		ldr	r0, [r4, r3, lsl #3]	@ unaligned
 1218 00a2 5168     		ldr	r1, [r2, #4]	@ unaligned
 1219 00a4 FFF7FEFF 		bl	debug_record
 1220              	.LVL101:
  92:tmk_core/common/action_tapping.c ****         } else {
 1221              		.loc 1 92 26 view .LVU387
  86:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1222              		.loc 1 86 56 view .LVU388
  86:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1223              		.loc 1 86 99 is_stmt 0 view .LVU389
 1224 00a8 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 1225 00aa 0133     		adds	r3, r3, #1
  86:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1226              		.loc 1 86 104 view .LVU390
 1227 00ac 03F00703 		and	r3, r3, #7
  86:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1228              		.loc 1 86 76 view .LVU391
 1229 00b0 3370     		strb	r3, [r6]
 1230              	.L127:
  86:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1231              		.loc 1 86 12 is_stmt 1 discriminator 1 view .LVU392
  86:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1232              		.loc 1 86 32 is_stmt 0 discriminator 1 view .LVU393
 1233 00b2 3078     		ldrb	r0, [r6]	@ zero_extendqisi2
  86:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1234              		.loc 1 86 5 discriminator 1 view .LVU394
 1235 00b4 3B78     		ldrb	r3, [r7]	@ zero_extendqisi2
 1236 00b6 8342     		cmp	r3, r0
 1237 00b8 E9D1     		bne	.L128
 1238              	.L118:
 100:tmk_core/common/action_tapping.c **** 
 1239              		.loc 1 100 1 view .LVU395
 1240 00ba 07B0     		add	sp, sp, #28
 1241              		.cfi_def_cfa_offset 20
 1242              		@ sp needed
 1243 00bc F0BD     		pop	{r4, r5, r6, r7, pc}
 1244              	.L131:
 1245 00be 00BF     		.align	2
 1246              	.L130:
 1247 00c0 00000000 		.word	.LANCHOR2
 1248 00c4 00000000 		.word	.LANCHOR0
 1249 00c8 00000000 		.word	.LANCHOR1
 1250 00cc 00000000 		.word	.LANCHOR3
 1251              		.cfi_endproc
 1252              	.LFE6:
 1254              		.section	.bss.tapping_key,"aw",%nobits
 1255              		.align	1
 1256              		.set	.LANCHOR3,. + 0
 1259              	tapping_key:
 1260 0000 00000000 		.space	8
 1260      00000000 
 1261              		.section	.bss.waiting_buffer,"aw",%nobits
 1262              		.align	1
 1263              		.set	.LANCHOR1,. + 0
 1266              	waiting_buffer:
 1267 0000 00000000 		.space	64
 1267      00000000 
 1267      00000000 
 1267      00000000 
 1267      00000000 
 1268              		.section	.bss.waiting_buffer_head,"aw",%nobits
 1269              		.set	.LANCHOR2,. + 0
 1272              	waiting_buffer_head:
 1273 0000 00       		.space	1
 1274              		.section	.bss.waiting_buffer_tail,"aw",%nobits
 1275              		.set	.LANCHOR0,. + 0
 1278              	waiting_buffer_tail:
 1279 0000 00       		.space	1
 1280              		.text
 1281              	.Letext0:
 1282              		.file 3 "c:\\qmk_msys\\mingw64\\arm-none-eabi\\include\\machine\\_default_types.h"
 1283              		.file 4 "c:\\qmk_msys\\mingw64\\arm-none-eabi\\include\\sys\\_stdint.h"
 1284              		.file 5 "tmk_core/common/keycode.h"
 1285              		.file 6 "tmk_core/common/action_code.h"
 1286              		.file 7 "tmk_core/common/action.h"
 1287              		.file 8 "tmk_core/common/action_layer.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 action_tapping.c
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:18     .text.debug_waiting_buffer:0000000000000000 $t
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:25     .text.debug_waiting_buffer:0000000000000000 debug_waiting_buffer
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:90     .text.debug_waiting_buffer:0000000000000028 $d
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:98     .text.debug_tapping_key:0000000000000000 $t
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:104    .text.debug_tapping_key:0000000000000000 debug_tapping_key
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:121    .text.debug_tapping_key:000000000000000c $d
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:126    .text.waiting_buffer_scan_tap:0000000000000000 $t
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:132    .text.waiting_buffer_scan_tap:0000000000000000 waiting_buffer_scan_tap
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:297    .text.waiting_buffer_scan_tap:0000000000000088 $d
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:307    .text.process_tapping:0000000000000000 $t
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:313    .text.process_tapping:0000000000000000 process_tapping
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1006   .text.process_tapping:00000000000002a0 $d
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1014   .text.get_tapping_term:0000000000000000 $t
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1021   .text.get_tapping_term:0000000000000000 get_tapping_term
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1039   .text.action_tapping_process:0000000000000000 $t
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1046   .text.action_tapping_process:0000000000000000 action_tapping_process
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1247   .text.action_tapping_process:00000000000000c0 $d
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1255   .bss.tapping_key:0000000000000000 $d
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1259   .bss.tapping_key:0000000000000000 tapping_key
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1262   .bss.waiting_buffer:0000000000000000 $d
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1266   .bss.waiting_buffer:0000000000000000 waiting_buffer
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1272   .bss.waiting_buffer_head:0000000000000000 waiting_buffer_head
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1273   .bss.waiting_buffer_head:0000000000000000 $d
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1278   .bss.waiting_buffer_tail:0000000000000000 waiting_buffer_tail
C:\Users\lhanj\AppData\Local\Temp\ccxP1Zu5.s:1279   .bss.waiting_buffer_tail:0000000000000000 $d

UNDEFINED SYMBOLS
debug_record
process_record
layer_switch_get_action
is_tap_record
debug_event
process_record_tap_hint
clear_keyboard
